import{u as e,j as t,P as r,T as n,a,b as o,B as s,L as i,C as l,c,O as u,_ as d,e as p,R as h}from"./three-fiber.DvjODXGb.js";import{b as f,R as m,u as g,c as y,B as x,d as w,e as b}from"./vendor.DRIiVZ8V.js";import{an as v,ah as j,e as S,a0 as C,ao as R,ap as M,c as E,a8 as A,aq as N,ar as T,a2 as O,as as k,at as I,E as U,au as P,av as D,p as F,aw as L,x as _,ax as z,ay as W,az as B,aA as q,aB as Y,aC as H,g as $,aD as X,aE as G,aF as V,aG as J,T as K}from"./three-core.CBnBGcbO.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Q=new j,Z=new v(Q),ee=new Map,te=async(e,t={})=>{const r=e+JSON.stringify(t);return ee.has(r)?ee.get(r):new Promise(((n,a)=>{Z.load(e,(e=>{e.anisotropy=t.anisotropy||16,e.colorSpace=t.colorSpace||E,e.generateMipmaps=void 0===t.generateMipmaps||t.generateMipmaps,e.flipY=void 0===t.flipY||t.flipY,e.wrapS=t.wrapS||A,e.wrapT=t.wrapT||A,e.needsUpdate=!0,ee.set(r,e),n(e)}),void 0,(e=>{a(e)}))}))},re=e=>{switch(e){case"🔥":return"#ff5722";case"💧":return"#2196f3";case"⚡":return"#ffc107";case"🪨":return"#795548";default:return"#9c27b0"}},ne=({cardData:a,isFullArt:o=!1})=>{const s=f.useRef(null),i=f.useRef(null),l=f.useRef(null),[c,u]=f.useState(!1),d={fontSize:.15,letterSpacing:.01,lineHeight:1.1,"material-toneMapped":!1,"material-transparent":!0,renderOrder:20};f.useEffect((()=>(o&&te("/textures/foil_pattern.jpg",{anisotropy:16,colorSpace:E,wrapS:N,wrapT:N}).then((e=>{e.repeat.set(3,3),i.current=e})).catch((e=>{})),te("/textures/border_pattern.jpg",{anisotropy:8,colorSpace:E,wrapS:N,wrapT:N}).then((e=>{e.repeat.set(4,4),l.current=e})).catch((e=>{})),()=>{})),[o]),f.useEffect((()=>{if(!a.normalImageUrl)return;const e=a.normalImageUrl;if(ee.has(e))return s.current=ee.get(e),void u(!0);const t=a.normalImageUrl.includes("ipfs.io"),r=t?`/api/proxy-image?url=${encodeURIComponent(a.normalImageUrl)}&timestamp=${Date.now()}&quality=high`:a.normalImageUrl;return te(r,{anisotropy:16,colorSpace:E}).then((t=>{s.current=t,ee.set(e,t),u(!0)})).catch((r=>{t&&te(a.normalImageUrl,{anisotropy:16,colorSpace:E}).then((t=>{s.current=t,ee.set(e,t),u(!0)})).catch((e=>{}))})),()=>{}}),[a.normalImageUrl]);const[p,h]=f.useState(null);f.useEffect((()=>{if(!o)return;const e=re(a.type),t=new S(e),r=new C({color:t,transparent:!0,opacity:.7,side:R});return h(r),()=>{r&&r.dispose()}}),[o,a.type]),e((({clock:e})=>{if(p&&p instanceof C){const t=e.getElapsedTime(),r=.1*Math.sin(.5*t)+.5,n=.7,a=.6;p.color.setHSL(r,n,a),p.needsUpdate=!0}}));const m=.02,g=.15,y=1.45,x=1.1-g,w=1.7,b=-.8,v=1.1-g,j=-1.4,A=.13,T=re(a.type),O=(e=>{switch(e){case"🔥":return"#ffcdd2";case"💧":return"#bbdefb";case"⚡":return"#fff9c4";case"🪨":return"#d7ccc8";default:return"#e1bee7"}})(a.type),k={envMapIntensity:.2,transparent:!0,depthWrite:!1,depthTest:!0},I=f.useRef(null),U=f.useRef(null),P=f.useRef(null);e((({clock:e})=>{const t=e.getElapsedTime();o||(I.current&&(I.current.position.z=m/3+.002*Math.sin(1.5*t)),U.current&&(U.current.position.z=m/6+.002*Math.sin(1.2*t+.5)),P.current&&(P.current.position.z=m/3+.002*Math.sin(1.3*t+1)))}));const D=f.useMemo((()=>(e,t={})=>new M({...k,color:e,roughness:t.roughness??.3,metalness:t.metalness??.2,clearcoat:t.clearcoat??.1,map:t.map??null,opacity:t.opacity??1})),[]);return t.jsxs(t.Fragment,{children:[!o&&t.jsxs(t.Fragment,{children:[t.jsx(r,{ref:I,args:[2.3,.48],position:[0,y,m/3],renderOrder:11,material:new M({...k,color:"#F5D76E",roughness:.3,metalness:.4,clearcoat:.2,clearcoatRoughness:.4,map:l.current||null})}),t.jsx(r,{args:[1.5,.38],position:[-.4,y,m/2.8],renderOrder:12,material:D(T,{roughness:.4,metalness:.2})}),t.jsx(r,{args:[.85,.38],position:[.7,y,m/2.7],renderOrder:12,material:D(T,{roughness:.4,metalness:.2})}),t.jsx(r,{args:[2.45,3.45],position:[0,0,.002],renderOrder:10,material:new M({...k,color:"#F5D76E",roughness:.3,metalness:.4,clearcoat:.3,clearcoatRoughness:.4,map:l.current||null})}),t.jsx(r,{ref:U,args:[w+.15,w+.15],position:[0,.3,m/6],renderOrder:11,material:new M({...k,color:"#F5D76E",roughness:.3,metalness:.5,clearcoat:.3,clearcoatRoughness:.4,map:l.current||null})}),t.jsx(r,{args:[1.8,1.8],position:[0,.3,.004],renderOrder:12,material:new M({...k,color:"#111111",roughness:.5,metalness:0})}),t.jsx(r,{args:[w,w],position:[0,.3,.021],renderOrder:15,material:s.current?new M({...k,map:s.current,toneMapped:!1,color:16777215,roughness:.2,metalness:.1,clearcoat:.1,clearcoatRoughness:.7,envMapIntensity:.4}):new M({...k,color:O,roughness:.3,metalness:.1})}),t.jsx(r,{ref:P,args:[2.3,.5],position:[0,b,m/3],renderOrder:11,material:new M({...k,color:"#F5D76E",roughness:.3,metalness:.4,clearcoat:.2,clearcoatRoughness:.4,map:l.current||null})}),t.jsx(r,{args:[2.2,.4],position:[0,b,.008],renderOrder:12,material:new M({...k,color:"#f8f8f8",roughness:.5,metalness:0,clearcoat:.05,clearcoatRoughness:.9})}),t.jsx(r,{args:[.25,.25],position:[-1,b,.01],renderOrder:13,material:o&&p?p:D(T,{roughness:.3,metalness:.4,clearcoat:.2})}),t.jsx(r,{args:[2.2,.35],position:[0,j,m/3],renderOrder:11,material:new M({...k,color:"#f5f5f5",roughness:.5,metalness:0,clearcoat:.05,clearcoatRoughness:.9})})]}),o&&p&&t.jsx(r,{args:[2.4,3.4],position:[0,0,.01],renderOrder:15,material:p}),t.jsx(n,{...d,position:[-.9,y,.03],fontSize:a.cardName.length>12?.144:.18,color:o?"#ffffff":"#000000",fontWeight:"bold",anchorX:"left",maxWidth:1.2,textAlign:"left",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,overflowWrap:"break-word",fillOpacity:1,renderOrder:25,children:a.cardName}),t.jsx(n,{...d,position:[.75,y,.03],fontSize:.16,color:o?"#ffffff":"#000000",fontWeight:"bold",anchorX:"right",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.hp}),t.jsx(n,{...d,position:[x,y,.03],fontSize:.25,anchorX:"right",outlineWidth:0,renderOrder:25,children:a.type}),t.jsx(n,{...d,position:[-.7,b,.03],fontSize:.15,color:o?"#ffffff":"#000000",fontWeight:"bold",anchorX:"left",maxWidth:1.4,textAlign:"left",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.move.name}),t.jsx(n,{...d,position:[v,b,.03],fontSize:.17,color:o?"#ffffff":"#000000",fontWeight:"bold",anchorX:"right",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.move.damage}),t.jsx(n,{...d,position:[-1,b,.03],fontSize:.15,fontWeight:"bold",anchorX:"center",anchorY:"middle",outlineWidth:0,renderOrder:25,children:a.type}),t.jsx(n,{...d,position:[-.8,j,.03],fontSize:A,color:o?"#ffffff":"#000000",anchorX:"center",textAlign:"center",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.weakness}),t.jsx(n,{...d,position:[0,j,.03],fontSize:A,color:o?"#ffffff":"#000000",anchorX:"center",textAlign:"center",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.resistance}),t.jsx(n,{...d,position:[.8,j,.03],fontSize:A,color:o?"#ffffff":"#000000",anchorX:"center",textAlign:"center",outlineWidth:o?.025:0,outlineColor:o?"#000000":void 0,outlineBlur:o?.001:0,renderOrder:25,children:a.rarity}),"⭐⭐⭐"===a.rarity&&t.jsx("pointLight",{position:[0,0,.5],distance:1.5,intensity:.3,color:T})]})};const ae=new class{resources=new Map;autoCleanupInterval=null;enabled=!0;stats={geometryCount:0,textureCount:0,materialCount:0,objectCount:0,disposedCount:0,estimatedMemoryUsage:0};constructor(e=6e4){e>0&&this.enableAutoCleanup(e)}track(e,t){const r=this.generateResourceId(e,t);return this.resources.set(r,{resource:e,type:t,createdAt:Date.now(),lastUsed:Date.now(),id:r}),this.updateStats(),e}trackSceneGraph(e){this.track(e,"object"),e.traverse((e=>{if(this.track(e,"object"),"material"in e){(Array.isArray(e.material)?e.material:[e.material]).forEach((e=>{e&&this.trackMaterial(e)}))}if("geometry"in e){const t=e.geometry;t&&t instanceof T&&this.track(t,"geometry")}}))}trackMaterial(e){if(!e)return;this.track(e,"material");const t=["map","normalMap","bumpMap","displacementMap","roughnessMap","metalnessMap","alphaMap","aoMap","emissiveMap","envMap","lightMap","clearcoatMap","clearcoatNormalMap","clearcoatRoughnessMap","transmissionMap","thicknessMap","sheenColorMap","sheenRoughnessMap","specularIntensityMap","specularColorMap","anisotropyMap","iridescenceMap","iridescenceThicknessMap","matcap"];for(const r of t){const t=e[r];t&&t instanceof O&&this.track(t,"texture")}}markAsUsed(e){const t=this.findResourceId(e);if(t&&this.resources.has(t)){this.resources.get(t).lastUsed=Date.now()}}dispose(e){const t=this.findResourceId(e);if(!t)return;const r=this.resources.get(t);r&&(this.disposeResource(r),this.resources.delete(t),this.stats.disposedCount++,this.updateStats())}disposeUnused(e=6e4){if(!this.enabled)return;const t=Date.now(),r=[];for(const[n,a]of this.resources.entries())t-a.lastUsed>e&&(this.disposeResource(a),r.push(n),this.stats.disposedCount++);r.forEach((e=>this.resources.delete(e))),r.length>0&&this.updateStats()}disposeAll(){for(const e of this.resources.values())this.disposeResource(e),this.stats.disposedCount++;this.resources.clear(),this.updateStats()}enableAutoCleanup(e=6e4){this.disableAutoCleanup(),this.autoCleanupInterval=window.setInterval((()=>{this.disposeUnused(e)}),e),this.enabled=!0}disableAutoCleanup(){null!==this.autoCleanupInterval&&(window.clearInterval(this.autoCleanupInterval),this.autoCleanupInterval=null)}getStats(){return this.updateStats(),{...this.stats}}setEnabled(e){this.enabled=e}generateResourceId(e,t){let r="";return r=e instanceof k?`obj_${e.uuid}`:e instanceof I?`mat_${e.uuid}`:e instanceof O?`tex_${e.uuid}`:e instanceof T?`geo_${e.uuid||e.id}`:`unknown_${Math.random().toString(36).substring(2,15)}`,r}findResourceId(e){for(const[t,r]of this.resources.entries())if(r.resource===e)return t;if("uuid"in e){const t=e.uuid;if(e instanceof k)return`obj_${t}`;if(e instanceof I)return`mat_${t}`;if(e instanceof O)return`tex_${t}`}return null}disposeResource(e){try{const{resource:t,type:r}=e;switch(r){case"object":if(t instanceof k&&t instanceof U){if((Array.isArray(t.material)?t.material:[t.material]).forEach((e=>{if(e){this.findResourceId(e)&&this.dispose(e)}})),t.geometry){this.findResourceId(t.geometry)&&this.dispose(t.geometry)}}break;case"material":t instanceof I&&(this.disposeMaterialTextures(t),t.dispose());break;case"texture":t instanceof O&&t.dispose();break;case"geometry":t instanceof T&&t.dispose()}}catch(t){}}disposeMaterialTextures(e){const t=["map","normalMap","bumpMap","displacementMap","roughnessMap","metalnessMap","alphaMap","aoMap","emissiveMap","envMap","lightMap","clearcoatMap","clearcoatNormalMap","clearcoatRoughnessMap","transmissionMap","thicknessMap","sheenColorMap","sheenRoughnessMap","specularIntensityMap","specularColorMap","anisotropyMap","iridescenceMap","iridescenceThicknessMap","matcap"];for(const r of t){const t=e[r];if(t&&t instanceof O){this.findResourceId(t)&&this.dispose(t)}}}updateStats(){let e=0,t=0,r=0,n=0,a=0;for(const o of this.resources.values())switch(o.type){case"geometry":if(e++,o.resource instanceof T){const e=o.resource;let t=0;for(const r in e.attributes){t+=e.attributes[r].array.byteLength||0}e.index&&(t+=e.index.array.byteLength||0),a+=t}break;case"texture":if(t++,o.resource instanceof O&&o.resource.image){a+=(o.resource.image.width||256)*(o.resource.image.height||256)*4*(o.resource.generateMipmaps?1.33:1)}else a+=1048576;break;case"material":r++,a+=1024;break;case"object":n++,a+=256}this.stats={geometryCount:e,textureCount:t,materialCount:r,objectCount:n,disposedCount:this.stats.disposedCount,estimatedMemoryUsage:a}}};function oe(e){if(e){if(e instanceof U){if(e.geometry&&e.geometry.dispose(),e.material){const t=Array.isArray(e.material)?e.material:[e.material];for(const e of t)if(e){for(const t of Object.keys(e)){const r=e[t];r instanceof O&&r.dispose()}e.dispose()}}}else e instanceof P&&e.traverse((e=>{e instanceof U&&oe(e)}));e.parent&&e.parent.remove(e)}}const se=new Map,ie=[];let le=0,ce=0;const ue=new j,de=new v(ue);let pe=0;function he(e){if(!e.image)return 0;const{width:t,height:r}=e.image;let n=t*r*4;return e.generateMipmaps&&(n*=1.33),e.format===L&&(n*=.75),n}function fe(e,t={}){e||(e="/placeholder.png");const r=ye(e,t);if(se.has(r)){const e=se.get(r);return ae.markAsUsed(e),Promise.resolve(e)}const n=ie.find((e=>ye(e.url,e.options)===r));return new Promise(n?(e,t)=>{n.resolve=t=>{e(t),n.resolve(t)},n.reject=e=>{t(e),n.reject(e)}}:(r,n)=>{ie.push({url:e,options:t,resolve:r,reject:n,priority:t.priority||"normal",addedTime:Date.now()}),ge()})}function me(e,t={}){if(!e||0===e.length)return Promise.resolve([]);const r=e.map((e=>fe(e,t)));return Promise.all(r)}function ge(){if(le>=6)return;ie.sort(((e,t)=>{const r={high:0,normal:1,low:2},n=r[e.priority]-r[t.priority];return 0!==n?n:e.addedTime-t.addedTime}));const e=ie.shift();if(!e)return;le++;const t=e.url;!function(){const e=Date.now();if(e-pe>5e3&&(le>0||ie.length>0)){se.size,ie.length;pe=e}}(),de.load(t,(r=>{try{r.anisotropy=e.options.anisotropy??4,r.generateMipmaps=e.options.generateMipmaps??!0,r.wrapS=e.options.wrapS??A,r.wrapT=e.options.wrapT??A,r.minFilter=e.options.minFilter??D,r.magFilter=e.options.magFilter??F,r.colorSpace=e.options.colorSpace??E,r.flipY=e.options.flipY??!0,r.needsUpdate=!0;const n=he(r);ce+=n,ce>104857600&&ae.disposeUnused(3e4);const a=ye(t,e.options);se.set(a,r),ae.track(r,"texture"),e.resolve(r)}catch(n){e.reject(n instanceof Error?n:new Error(`${n}`))}finally{le--,ge()}}),(t=>{e.options.onProgress&&e.options.onProgress(t?t.loaded/t.total:0)}),(r=>{e.reject(new Error(`Failed to load texture: ${t}`)),le--,ge()})),le<6&&ie.length>0&&ge()}function ye(e,t){return`${e}|${[t.anisotropy,t.generateMipmaps,t.wrapS,t.wrapT,t.minFilter,t.magFilter,t.colorSpace,t.flipY].join("|")}`}const xe=(e,t=!1,r={})=>{if(!e)return e;const n=e.includes("theapi.app"),a=Date.now(),o=new URLSearchParams;return o.append("url",e),o.append("timestamp",a.toString()),n||(t||we(e))&&o.append("midjourney","true"),r.thumbnail&&o.append("thumbnail","1"),r.quality&&o.append("quality",r.quality),r.timeout&&o.append("timeout",r.timeout.toString()),`/api/proxy-image?${o.toString()}`},we=e=>!!e&&(e.includes("midjourney.com")||e.includes("cdn.midjourney.com")||/cdn\.midjourney\.com\/[a-f0-9-]{36}\//.test(e)||/\/[a-f0-9-]{8}-[a-f0-9-]{4}-[a-f0-9-]{4}-[a-f0-9-]{4}-[a-f0-9-]{12}\//.test(e));async function be(e,t={}){if(!e)return t.withPlaceholder&&t.placeholderUrl?fe(t.placeholderUrl,{anisotropy:t.anisotropy||4,priority:t.priority||"high"}):null;const r=we(e)?`/api/proxy-image?url=${encodeURIComponent(e)}&midjourney=true&timestamp=${Date.now()}&quality=high`:xe(e);try{return await fe(r,{anisotropy:t.anisotropy||4,priority:t.priority||"normal"})}catch(n){if(!r.includes("/api/proxy-image"))try{const r=`/api/proxy-image?url=${encodeURIComponent(e)}&timestamp=${Date.now()}&quality=high`;return await fe(r,{anisotropy:t.anisotropy||4,priority:t.priority||"normal"})}catch(a){}if(t.withPlaceholder&&t.placeholderUrl)try{return await fe(t.placeholderUrl,{anisotropy:t.anisotropy||4,priority:t.priority||"high"})}catch(o){}return null}}function ve(e={}){const t=new z({map:e.map||void 0,color:void 0!==e.color?e.color:16777215,roughness:void 0!==e.roughness?e.roughness:.5,metalness:void 0!==e.metalness?e.metalness:.1,envMapIntensity:void 0!==e.envMapIntensity?e.envMapIntensity:1,transparent:void 0!==e.transparent&&e.transparent,opacity:void 0!==e.opacity?e.opacity:1,side:e.side||R});return ae.trackMaterial(t),t}function je(...e){e.forEach((e=>{e&&oe(e)})),function(e=6e4){ae.disposeUnused(e),ce=0,se.forEach((e=>{ce+=he(e)}))}(3e4)}const Se=new j,Ce="/cardback.jpg",Re=e=>{switch(e){case"🔥":return"#ffcdd2";case"💧":return"#bbdefb";case"⚡":return"#fff9c4";case"🪨":return"#d7ccc8";default:return"#e8eaf6"}},Me=()=>{const r=f.useRef(null),n=f.useMemo((()=>{const e=[];for(let t=0;t<=24;t++){const r=t/24*Math.PI*2;e.push(new $(.15*Math.cos(r),.15*Math.sin(r),0))}return e}),[]);return e((({clock:e})=>{if(r.current){r.current.rotation.z=2*-e.getElapsedTime();const t=.1*Math.sin(4*e.getElapsedTime())+.9;r.current.scale.set(t,t,1)}})),t.jsxs("group",{ref:r,children:[t.jsx(i,{points:n,color:"#ffffff",lineWidth:3,transparent:!0,opacity:.8,renderOrder:101}),t.jsx(i,{points:[n[0],n[1],n[2],n[3],n[4]],color:"#4fc3f7",lineWidth:5,transparent:!0,opacity:1,renderOrder:102})]})},Ee=new j,Ae=new v(Ee),Ne=new Map,Te=e=>{switch(e){case"🔥":return"#ff5722";case"💧":return"#2196f3";case"⚡":return"#ffc107";case"🪨":return"#795548";default:return"#9c27b0"}},Oe=async(e,t={})=>{const r=e+JSON.stringify(t);return Ne.has(r)?Ne.get(r):new Promise(((n,a)=>{Ae.load(e,(e=>{e.anisotropy=t.anisotropy||16,e.colorSpace=t.colorSpace||E,e.generateMipmaps=void 0===t.generateMipmaps||t.generateMipmaps,e.flipY=void 0===t.flipY||t.flipY,e.wrapS=t.wrapS||A,e.wrapT=t.wrapT||A,e.needsUpdate=!0,Ne.set(r,e),n(e)}),void 0,(e=>{a(e)}))}))},ke=({cardData:i,isFullArt:l=!1,isLoading:c,showHoloFoil:u=!0,showNormalMap:d=!0,showRoughnessMap:p=!0,showEdgeHighlight:h=!0,showParticles:m=!0,onImageLoadStart:g,onImageLoadComplete:y,onImageLoadError:x,quality:w="medium"})=>{const{gl:b}=a(),v=o({preset:"city"}),[j,C]=f.useState(!1),[M,A]=f.useState(!1),[T,O]=f.useState(!1),[k,I]=f.useState(!1),U=f.useRef(null),P=f.useRef(null),D=f.useRef(null),F=f.useRef(null),L=f.useMemo((()=>xe(i.normalImageUrl)),[i.normalImageUrl]),z=f.useMemo((()=>i.fullArtImageUrl?xe(i.fullArtImageUrl):null),[i.fullArtImageUrl]),W=2.5,B=3.5,q=.05,$=.01,X=f.useRef(null);f.useEffect((()=>{b.capabilities.getMaxAnisotropy(),Ee.onLoad=()=>{},Oe("/textures/foil_pattern.jpg",{anisotropy:16,colorSpace:E,wrapS:N,wrapT:N}).then((e=>{D.current=e,e.repeat.set(3,3),O(!0)})).catch((e=>{const t=document.createElement("canvas");t.width=512,t.height=512;const r=t.getContext("2d");if(r){const e=r.createRadialGradient(t.width/2,t.height/2,0,t.width/2,t.height/2,t.width/2);e.addColorStop(0,"#ff0000"),e.addColorStop(.2,"#ffff00"),e.addColorStop(.4,"#00ff00"),e.addColorStop(.6,"#00ffff"),e.addColorStop(.8,"#0000ff"),e.addColorStop(1,"#ff00ff"),r.fillStyle=e,r.fillRect(0,0,t.width,t.height);for(let n=0;n<1e4;n++){const e=Math.random()*t.width,n=Math.random()*t.height;r.fillStyle=`rgba(255,255,255,${.2*Math.random()})`,r.fillRect(e,n,2,2)}}const n=new Y(t);n.repeat.set(3,3),n.wrapS=N,n.wrapT=N,D.current=n,O(!0)}));const e=document.createElement("canvas");e.width=512,e.height=512;const t=e.getContext("2d");if(t){const r=t.createLinearGradient(0,0,e.width,e.height);r.addColorStop(0,"#ff0000"),r.addColorStop(.17,"#ff7f00"),r.addColorStop(.33,"#ffff00"),r.addColorStop(.5,"#00ff00"),r.addColorStop(.67,"#0000ff"),r.addColorStop(.83,"#4b0082"),r.addColorStop(1,"#9400d3"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),t.strokeStyle="rgba(255,255,255,0.2)",t.lineWidth=5;for(let n=-e.height;n<e.width;n+=20)t.beginPath(),t.moveTo(n,0),t.lineTo(n+e.height,e.height),t.stroke();for(let n=0;n<2e3;n++){const r=Math.random()*e.width,n=Math.random()*e.height,a=2*Math.random()+1;t.fillStyle=`rgba(255,255,255,${.5*Math.random()})`,t.fillRect(r,n,a,a)}}const r=new Y(e);r.repeat.set(2,2),r.wrapS=N,r.wrapT=N,F.current=r,I(!0)}),[b]),f.useEffect((()=>{if(g&&g(),!L)return void(x&&x(new Error("Normal image URL is missing")));const e=we(L)?`/api/proxy-image?url=${encodeURIComponent(L)}&midjourney=true&timestamp=${Date.now()}&quality=high`:L;if(Oe(e,{anisotropy:16,colorSpace:E}).then((e=>{U.current=e,C(!0),y&&y()})).catch((e=>{const t=`/api/proxy-image?url=${encodeURIComponent(L)}&timestamp=${Date.now()}&quality=high`;Oe(t,{anisotropy:16,colorSpace:E}).then((e=>{U.current=e,C(!0),y&&y()})).catch((e=>{x&&x(new Error("Failed to load normal image")),Oe("/cardback.jpg",{anisotropy:16,colorSpace:E}).then((e=>{U.current=e,C(!0)}))}))})),z){const e=we(z)?`/api/proxy-image?url=${encodeURIComponent(z)}&midjourney=true&timestamp=${Date.now()}&quality=high`:z;Oe(e,{anisotropy:16,colorSpace:E}).then((e=>{P.current=e,A(!0)})).catch((e=>{const t=`/api/proxy-image?url=${encodeURIComponent(z)}&timestamp=${Date.now()}&quality=high`;Oe(t,{anisotropy:16,colorSpace:E}).then((e=>{P.current=e,A(!0)})).catch((e=>{}))}))}return()=>{}}),[L,z,y,x,g]);const[G,V]=f.useState(null);f.useEffect((()=>{const e=Te(i.type),t=new S(e),r=new _({uniforms:{time:{value:0},holoTexture:{value:null},rainbowTexture:{value:null},baseColor:{value:t},holoIntensity:{value:i.rarity.length/3}},vertexShader:"\n      varying vec2 vUv;\n      varying vec3 vPosition;\n      varying vec3 vViewPosition;\n      varying vec3 vNormal;\n      \n      void main() {\n        vUv = uv;\n        vPosition = position;\n        vNormal = normalize(normalMatrix * normal);\n        \n        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n        vViewPosition = -mvPosition.xyz;\n        \n        gl_Position = projectionMatrix * mvPosition;\n      }\n    ",fragmentShader:"\n      uniform float time;\n      uniform sampler2D holoTexture;\n      uniform sampler2D rainbowTexture;\n      uniform vec3 baseColor;\n      uniform float holoIntensity;\n      \n      varying vec2 vUv;\n      varying vec3 vPosition;\n      varying vec3 vViewPosition;\n      varying vec3 vNormal;\n      \n      // Function to create rainbow color based on position and time\n      vec3 rainbowColor(float t) {\n        vec3 color = 0.5 + 0.5 * cos(6.28318 * (t + vec3(0.0, 0.33, 0.67)));\n        return color;\n      }\n      \n      void main() {\n        // Sample the holographic texture with moving coordinates\n        vec2 holoUv = vUv;\n        holoUv.x += sin(vUv.y * 10.0 + time * 0.5) * 0.02;\n        holoUv.y += cos(vUv.x * 10.0 + time * 0.3) * 0.02;\n        vec4 holoColor = texture2D(holoTexture, holoUv);\n        \n        // Sample the rainbow texture with different movement\n        vec2 rainbowUv = vUv;\n        rainbowUv.x += sin(time * 0.2) * 0.1;\n        rainbowUv.y += cos(time * 0.1) * 0.1;\n        vec4 rainbowColor = texture2D(rainbowTexture, rainbowUv);\n        \n        // Calculate view-dependent effect (more visible at glancing angles)\n        vec3 viewDir = normalize(vViewPosition);\n        float fresnel = pow(1.0 - abs(dot(viewDir, vNormal)), 3.0);\n        \n        // Calculate dynamic rainbow based on position and time\n        float rainbowT = vPosition.x * 0.2 + vPosition.y * 0.1 + time * 0.1;\n        vec3 dynamicRainbow = rainbowColor(rainbowT);\n        \n        // Add movement to the effect based on position\n        float movement = sin(vPosition.x * 5.0 + vPosition.y * 3.0 + time * 2.0) * 0.5 + 0.5;\n        \n        // Combine all effects: base color + holo pattern + rainbow + fresnel\n        vec3 finalColor = mix(\n          baseColor,\n          holoColor.rgb * rainbowColor.rgb * dynamicRainbow,\n          fresnel * holoIntensity * movement\n        );\n        \n        // Add extra rainbow lines at strong angles\n        finalColor += dynamicRainbow * fresnel * fresnel * 0.3 * movement;\n        \n        gl_FragColor = vec4(finalColor, 0.7 + fresnel * 0.3);\n      }\n    ",transparent:!0,side:R});return V(r),()=>{r&&r.dispose()}}),[i.type,i.rarity]),e((({clock:e})=>{G&&(G.uniforms.time.value=e.getElapsedTime(),D.current&&G.uniforms.holoTexture.value!==D.current&&(G.uniforms.holoTexture.value=D.current),F.current&&G.uniforms.rainbowTexture.value!==F.current&&(G.uniforms.rainbowTexture.value=F.current))})),e((e=>{if(!X.current||c)return;const t=e.clock.elapsedTime,r=X.current;if(r.userData.targetRotationY=void 0!==r.userData.targetRotationY?r.userData.targetRotationY:0,r.userData.targetRotationX=void 0!==r.userData.targetRotationX?r.userData.targetRotationX:0,r.userData.isInteractive=void 0!==r.userData.isInteractive&&r.userData.isInteractive,r.userData.isInteractive)r.rotation.y+=.1*(r.userData.targetRotationY-r.rotation.y),r.rotation.x+=.1*(r.userData.targetRotationX-r.rotation.x),r.rotation.z=.005*Math.sin(.5*t);else{r.position.y=.03*Math.sin(.5*t),r.position.x=.015*Math.sin(.3*t);const e=.05*Math.sin(.4*t),n=.02*Math.sin(.45*t),a=.008*Math.sin(.5*t);r.rotation.y+=.05*(e-r.rotation.y),r.rotation.x+=.05*(n-r.rotation.x),r.rotation.z+=.05*(a-r.rotation.z)}}));const J=Te(i.type),K=(e=>{switch(e){case"🔥":return"#ffcdd2";case"💧":return"#bbdefb";case"⚡":return"#fff9c4";case"🪨":return"#d7ccc8";default:return"#e1bee7"}})(i.type),Q=1.525,Z=-1.52,ee=.2-1.37,te=-.7700000000000002,re=.18;return t.jsxs(t.Fragment,{children:[t.jsxs("mesh",{position:[0,-.1,-.5],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[t.jsx("planeGeometry",{args:[10,10]}),t.jsx("shadowMaterial",{transparent:!0,opacity:.2})]}),t.jsxs("group",{ref:X,visible:!c,onPointerMove:e=>{if(!X.current||c)return;const t=.25*(e.point.x/5*2),r=.25*(e.point.y/5*2);X.current.userData.targetRotationY=t,X.current.userData.targetRotationX=r,X.current.userData.isInteractive=!0},onPointerLeave:()=>{X.current&&!c&&(X.current.userData.targetRotationY=0,X.current.userData.targetRotationX=0,X.current.userData.isInteractive=!1)},children:[t.jsx(s,{args:[W,B,q],position:[0,0,-.025],children:t.jsx("meshStandardMaterial",{color:"🫘"===i.type?"#f8f6f2":K,roughness:.6,metalness:.1,envMap:v,envMapIntensity:.2})}),t.jsx(s,{args:[W,B,q],position:[0,0,-.025],children:t.jsx("meshStandardMaterial",{color:"#e0e0e0",roughness:.5,metalness:.2,envMap:v,envMapIntensity:.3,side:H})}),t.jsx(r,{args:[W,B],position:[0,0,0],children:t.jsx("meshStandardMaterial",{color:"🫘"===i.type?"#f8f6f2":K,roughness:.4,metalness:.15,envMap:v,envMapIntensity:.25})}),!l&&t.jsx(t.Fragment,{children:(()=>{const e=1.98,n=2.002,a=.474,o=-.727,s={imageY:a,setIconY:o,moveBoxY:-1.127,weaknessY:-1.5};return"undefined"!=typeof window&&(window._normalCardCalculatedPositions=s),t.jsxs(t.Fragment,{children:[t.jsx(r,{args:[W,.05],position:[0,1.725,.008],children:t.jsx("meshStandardMaterial",{color:"#dedede",roughness:.5,metalness:.2,envMap:v,envMapIntensity:.2})}),t.jsx(r,{args:[W,.05],position:[0,-1.725,.008],children:t.jsx("meshStandardMaterial",{color:"#dedede",roughness:.5,metalness:.2,envMap:v,envMapIntensity:.2})}),t.jsx(r,{args:[.05,3.4],position:[-1.225,0,.008],children:t.jsx("meshStandardMaterial",{color:"#dedede",roughness:.5,metalness:.2,envMap:v,envMapIntensity:.2})}),t.jsx(r,{args:[.05,3.4],position:[1.225,0,.008],children:t.jsx("meshStandardMaterial",{color:"#dedede",roughness:.5,metalness:.2,envMap:v,envMapIntensity:.2})}),t.jsx(r,{args:[2.03,n+.05],position:[0,a,$-.001],children:t.jsx("meshStandardMaterial",{color:"#f0f0f0",roughness:.4,metalness:.3,envMap:v,envMapIntensity:.25})}),t.jsx(r,{args:[e,n],position:[0,a,$],children:t.jsx("meshStandardMaterial",{map:U.current||void 0,color:U.current?16777215:K,roughness:.2,metalness:.1,envMap:v,envMapIntensity:.2,transparent:!0})}),t.jsx(r,{args:[e,n],position:[0,a,.011],children:t.jsx("meshPhysicalMaterial",{color:"#ffffff",roughness:.1,metalness:.1,clearcoat:1,clearcoatRoughness:.2,envMap:v,envMapIntensity:.5,transparent:!0,opacity:.1})})]})})()}),l&&P.current&&t.jsxs(t.Fragment,{children:[t.jsx(r,{args:[2.4,3.4],position:[0,0,.007],children:t.jsx("meshStandardMaterial",{color:J,roughness:.3,metalness:.6,envMap:v,envMapIntensity:.4,transparent:!0,opacity:.4})}),t.jsx(r,{args:[2.38,3.38],position:[0,0,.008],children:t.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.2,metalness:.5,envMap:v,envMapIntensity:.5,transparent:!0,opacity:.5})}),t.jsx(r,{args:[2.32,3.32],position:[0,0,$],children:t.jsx("meshStandardMaterial",{map:P.current,roughness:.2,metalness:.3,envMap:v,envMapIntensity:.3,transparent:!0})}),t.jsx(r,{args:[2.32,3.32],position:[0,0,.011],children:t.jsx("meshPhysicalMaterial",{color:"#ffffff",roughness:.1,metalness:.4,clearcoat:1,clearcoatRoughness:.1,envMap:v,envMapIntensity:.8,transparent:!0,opacity:.15})})]}),l&&!P.current&&t.jsxs(t.Fragment,{children:[t.jsx(r,{args:[2.4,3.4],position:[0,0,.007],children:t.jsx("meshStandardMaterial",{color:J,roughness:.3,metalness:.6,envMap:v,envMapIntensity:.4,transparent:!0,opacity:.4})}),t.jsx(r,{args:[2.38,3.38],position:[0,0,.008],children:t.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.2,metalness:.5,envMap:v,envMapIntensity:.5,transparent:!0,opacity:.5})}),t.jsx(r,{args:[2.32,3.32],position:[0,0,$],children:t.jsx("meshStandardMaterial",{map:U.current||void 0,color:U.current?16777215:K,roughness:.2,metalness:.3,envMap:v,envMapIntensity:.3,transparent:!0})}),i.fullArtImageUrl&&t.jsx(n,{position:[0,0,.02],fontSize:.15,color:"#ffffff",fontWeight:"bold",anchorX:"center",anchorY:"middle",maxWidth:2,textAlign:"center","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:.03,outlineColor:"#000000",children:"Full Art Coming Soon"})]}),!l&&t.jsxs(t.Fragment,{children:[t.jsxs("group",{position:[0,0,.04],children:[t.jsx(n,{position:[-1.1,Q,0],color:"#000000",fontWeight:"bold",anchorX:"left",anchorY:"middle",maxWidth:1.45,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,fillOpacity:1,children:i.cardName||"Card Name",fontSize:(()=>{const e=(i.cardName||"Card Name").length;return e<=12?re:e<=18?re*(1-.042*(e-12)):e<=25?re*(.75-.036*(e-18)):.09})()}),t.jsx(n,{position:[1.2,Q,0],fontSize:.23399999999999999,anchorX:"right",anchorY:"middle",maxWidth:.25,textAlign:"right","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,children:i.type}),t.jsx(n,{position:[.9,Q,0],fontSize:Math.min(.198,5/Math.max(3,(i.hp||"120").length)*.198),color:"#000000",fontWeight:"bold",anchorX:"right",anchorY:"middle",maxWidth:.625,textAlign:"right","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,children:i.hp})]}),t.jsx("group",{position:[0,0,.04],children:(()=>{const e="undefined"!=typeof window&&window._normalCardCalculatedPositions?window._normalCardCalculatedPositions.moveBoxY:-.4;return t.jsxs(t.Fragment,{children:[t.jsx(n,{position:[-1,e,.023],fontSize:.12,color:"#000000",fontWeight:"bold",anchorX:"left",anchorY:"middle",maxWidth:1.9,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,renderOrder:30,letterSpacing:.01,children:i.move.name}),t.jsx(n,{position:[1,e,.023],fontSize:.12,color:"#000000",fontWeight:"bold",anchorX:"right",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,renderOrder:30,children:i.move.damage})]})})()}),t.jsx("group",{position:[0,0,.04],children:(()=>{const e="undefined"!=typeof window&&window._normalCardCalculatedPositions?window._normalCardCalculatedPositions.weaknessY:-1.5;return t.jsxs(t.Fragment,{children:[t.jsxs(n,{position:[-.625,e,0],fontSize:.099,color:"#000000",fontWeight:"bold",anchorX:"center",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,children:["Weakness: ",i.weakness||"💧 x2"]}),t.jsxs(n,{position:[.625,e,0],fontSize:.099,color:"#000000",fontWeight:"bold",anchorX:"center",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,children:["Resistance: ",i.resistance||"🪨 -20"]})]})})()}),t.jsx("group",{position:[0,0,.04],children:(()=>{const e=(i.traits||"Human, Samurai, Rare").split(",").map((e=>{const t=e.split(":");return t.length>1?t[1].trim():e.trim()})).filter((e=>e)).join(", ").split(", ").join(" • "),r=i.traits&&i.traits.match(/Azuki #(\d+)/),a=r?"#"+r[1]:"#1834",o=Math.floor(105)-(a.length+3);let s,l;if(e.length<=o)s=e,l="";else{let t=-1,r=0;for(;;){const n=e.indexOf(" • ",r+1);if(-1===n||n>o)break;t=n,r=n+3}if(t>0)s=e.substring(0,t),l=e.substring(t+3);else if(s=e.substring(0,o),l=e.substring(o)," "!==s.charAt(s.length-1)&&" "!==l.charAt(0)){const t=s.lastIndexOf(" ");t>.7*o&&(s=e.substring(0,t),l=e.substring(t+1))}}const c="undefined"!=typeof window&&window._normalCardCalculatedPositions?window._normalCardCalculatedPositions.setIconY:-.8;return t.jsxs(t.Fragment,{children:[t.jsxs(n,{position:[-1.13,c+(l?.07:0),0],fontSize:.068,color:"#000000",anchorX:"left",anchorY:"middle",maxWidth:2.25,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,fontWeight:"bold",letterSpacing:.004,children:[a," • ",s]}),l&&t.jsx(n,{position:[-1.13,c-.07,0],fontSize:.068,color:"#000000",anchorX:"left",anchorY:"middle",maxWidth:2.25,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,fontWeight:"bold",letterSpacing:.004,children:l})]})})()})]}),l&&t.jsxs(t.Fragment,{children:[t.jsxs("group",{position:[0,0,.04],children:[t.jsx(n,{position:[-1.1,Q,0],color:"#000000",fontWeight:"bold",anchorX:"left",anchorY:"middle",maxWidth:1.45,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,outlineColor:"#ffffff",fillOpacity:1,children:i.cardName||"Card Name",fontSize:(()=>{const e=(i.cardName||"Card Name").length;return e<=12?re:e<=18?re*(1-.042*(e-12)):e<=25?re*(.75-.036*(e-18)):.09})(),outlineWidth:(()=>{const e=(i.cardName||"Card Name").length;return.028*(e<=12?1:e<=18?1-.042*(e-12):e<=25?.75-.036*(e-18):.5)})()}),t.jsx(n,{position:[1.2,Q,0],fontSize:.23399999999999999,anchorX:"right",anchorY:"middle",maxWidth:.25,textAlign:"right","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,children:i.type}),t.jsx(n,{position:[.9,Q,0],fontSize:Math.min(.198,5/Math.max(3,(i.hp||"120").length)*.198),color:"#000000",fontWeight:"bold",anchorX:"right",anchorY:"middle",maxWidth:.625,textAlign:"right","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:Math.min(.028,5/Math.max(3,(i.hp||"120").length)*.028),outlineColor:"#ffffff",children:i.hp})]}),t.jsxs("group",{position:[0,0,.04],children:[t.jsx(n,{position:[-1,te,0],fontSize:.12,color:"#000000",fontWeight:"bold",anchorX:"left",anchorY:"middle",maxWidth:1.9,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,outlineWidth:.011,outlineColor:"#ffffff",letterSpacing:.01,children:i.move.name}),t.jsx(n,{position:[1,te,0],fontSize:.12,color:"#000000",fontWeight:"bold",anchorX:"right",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,depthWrite:!1,renderOrder:20,outlineWidth:.011,outlineColor:"#ffffff",children:i.move.damage})]}),t.jsx("group",{position:[0,0,.04],children:(()=>{const e=(i.traits||"Human, Samurai, Rare").split(",").map((e=>{const t=e.split(":");return t.length>1?t[1].trim():e.trim()})).filter((e=>e)).join(", ").split(", ").join(" • "),r=i.traits&&i.traits.match(/Azuki #(\d+)/),a=r?"#"+r[1]:"#1834",o=Math.floor(105)-(a.length+3);let s,l;if(e.length<=o)s=e,l="";else{let t=-1,r=0;for(;;){const n=e.indexOf(" • ",r+1);if(-1===n||n>o)break;t=n,r=n+3}if(t>0)s=e.substring(0,t),l=e.substring(t+3);else if(s=e.substring(0,o),l=e.substring(o)," "!==s.charAt(s.length-1)&&" "!==l.charAt(0)){const t=s.lastIndexOf(" ");t>.7*o&&(s=e.substring(0,t),l=e.substring(t+1))}}return t.jsxs(t.Fragment,{children:[t.jsxs(n,{position:[-1.13,Z+(l?.07:0),0],fontSize:.068,color:"#000000",anchorX:"left",anchorY:"middle",maxWidth:2.25,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:.006,outlineColor:"#ffffff",fontWeight:"bold",letterSpacing:.004,children:[a," • ",s]}),l&&t.jsx(n,{position:[-1.13,-1.59,0],fontSize:.068,color:"#000000",anchorX:"left",anchorY:"middle",maxWidth:2.25,textAlign:"left","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:.006,outlineColor:"#ffffff",fontWeight:"bold",letterSpacing:.004,children:l})]})})()}),t.jsxs("group",{position:[0,0,.04],children:[t.jsxs(n,{position:[-.625,ee,0],fontSize:.099,color:"#000000",fontWeight:"bold",anchorX:"center",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:.006,outlineColor:"#ffffff",children:["Weakness: ",i.weakness||"💧 x2"]}),t.jsxs(n,{position:[.625,ee,0],fontSize:.099,color:"#000000",fontWeight:"bold",anchorX:"center",anchorY:"middle","material-toneMapped":!1,"material-transparent":!0,renderOrder:20,outlineWidth:.006,outlineColor:"#ffffff",children:["Resistance: ",i.resistance||"🪨 -20"]})]})]}),c&&t.jsxs(t.Fragment,{children:[t.jsx(n,{position:[0,0,.1],fontSize:.2,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",renderOrder:100,children:"Loading..."}),t.jsx("group",{position:[0,-.5,.1],children:t.jsx(Me,{})})]}),!c&&l&&!M&&i.fullArtImageUrl&&t.jsxs(t.Fragment,{children:[t.jsx(n,{position:[0,0,.1],fontSize:.15,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",renderOrder:100,children:"Loading Full Art..."}),t.jsx("group",{position:[0,-.3,.1],children:t.jsx(Me,{})})]}),!c&&!l&&!j&&t.jsxs(t.Fragment,{children:[t.jsx(n,{position:[0,0,.1],fontSize:.15,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",renderOrder:100,children:"Loading Card Image..."}),t.jsx("group",{position:[0,-.3,.1],children:t.jsx(Me,{})})]})]})]})},Ie=({cardData:e,isLoading:r=!1,isFullArt:n=!1,showHoloFoil:a=!0,showNormalMap:o=!0,showRoughnessMap:s=!0,showEdgeHighlight:i=!0,showParticles:d=!0,onImageLoadStart:p,onImageLoadComplete:h,onImageLoadError:m,quality:g="medium"})=>t.jsx("div",{style:{width:"100%",height:"100%",position:"relative"},children:t.jsxs(l,{shadows:!0,gl:{antialias:!0,alpha:!0},style:{background:"linear-gradient(to bottom, #f0f0f0, #e0e0e0)"},children:[t.jsx(c,{makeDefault:!0,position:[0,0,6],fov:40}),t.jsx("ambientLight",{intensity:.5}),t.jsx("directionalLight",{position:[10,10,10],intensity:.8,castShadow:!0}),t.jsx("pointLight",{position:[-5,-5,3],intensity:.3,distance:15,color:"#ffffff"}),t.jsx("spotLight",{position:[0,5,8],intensity:.5,angle:.5,penumbra:.8,distance:20,color:"#f0f0ff"}),t.jsx(f.Suspense,{fallback:null,children:t.jsx(ke,{cardData:e,isFullArt:n,isLoading:r,showHoloFoil:a,showNormalMap:o,showRoughnessMap:s,showEdgeHighlight:i,showParticles:d,onImageLoadStart:p,onImageLoadComplete:h,onImageLoadError:m,quality:g})}),t.jsx(u,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:3,maxDistance:8})]})}),Ue=Object.freeze(Object.defineProperty({__proto__:null,Card3D:({cardData:r,isFullArt:s,isLoading:i,onImageLoadStart:l,onImageLoadComplete:c,onImageLoadError:u,showNormalMap:d=!0,showRoughnessMap:p=!0,showHoloFoil:h=!0,showEdgeHighlight:m=!0,showParticles:g=!0})=>{const{gl:y}=a();o({preset:"city"});const[x,w]=f.useState(!1),[b,j]=f.useState(!1),C=f.useRef(null),M=f.useRef(null),E=f.useRef(null),A=f.useRef(null),O=f.useRef(null),k=f.useMemo((()=>xe(r.normalImageUrl)),[r.normalImageUrl]),I=f.useMemo((()=>{if(!r.fullArtImageUrl)return null;const e=we(r.fullArtImageUrl);return xe(r.fullArtImageUrl,e,{quality:"high"})}),[r.fullArtImageUrl]),U=2.5,P=3.5,D=f.useRef(null),F=f.useRef(null);f.useEffect((()=>{y.capabilities.getMaxAnisotropy(),Se.onLoad=()=>{}}),[y]),f.useEffect((()=>(be("/textures/normal_map.jpg",{anisotropy:8,priority:"high",withPlaceholder:!0}).then((e=>{e&&(e.repeat.set(1,1),A.current=e)})),be("/textures/roughness_map.jpg",{anisotropy:8,priority:"high",withPlaceholder:!0}).then((e=>{e&&(e.repeat.set(1,1),O.current=e)})),be(Ce,{anisotropy:16,priority:"high"}).then((e=>{e&&(E.current=e)})),()=>{je(D.current||void 0),[A,O,E,C,M].forEach((e=>{e.current&&(e.current=null)}))})),[]),f.useEffect((()=>(l&&l(),be(k,{anisotropy:16,priority:"high",withPlaceholder:!0,placeholderUrl:Ce}).then((e=>{e&&(C.current=e,w(!0),c&&c())})).catch((e=>{u&&u(new Error("Failed to load card image"))})),I&&setTimeout((()=>{be(I,{anisotropy:16,priority:"normal",withPlaceholder:!0,placeholderUrl:"/cardback.jpg"}).then((e=>{e&&(M.current=e,j(!0))})).catch((e=>{u&&u(new Error("Failed to load full art image"))}))}),500),()=>{})),[k,I,c,u,l]);const[L,z]=f.useState(null);f.useEffect((()=>{if(!s)return;const e=function(e={}){const t=e.baseColor||new S("#4f81c7"),r=new _({uniforms:{time:{value:0},holoTexture:{value:e.holoTexture||null},rainbowTexture:{value:e.rainbowTexture||null},baseColor:{value:t},holoIntensity:{value:e.holoIntensity||1}},vertexShader:"\n    varying vec2 vUv;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec3 vNormal;\n    \n    void main() {\n      vUv = uv;\n      vPosition = position;\n      vNormal = normalize(normalMatrix * normal);\n      \n      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n      vViewPosition = -mvPosition.xyz;\n      \n      gl_Position = projectionMatrix * mvPosition;\n    }\n  ",fragmentShader:"\n    uniform float time;\n    uniform sampler2D holoTexture;\n    uniform sampler2D rainbowTexture;\n    uniform vec3 baseColor;\n    uniform float holoIntensity;\n    \n    varying vec2 vUv;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec3 vNormal;\n    \n    // Function to create rainbow color based on position and time\n    vec3 rainbowColor(float t) {\n      vec3 color = 0.5 + 0.5 * cos(6.28318 * (t + vec3(0.0, 0.33, 0.67)));\n      return color;\n    }\n    \n    void main() {\n      // Sample the holographic texture with moving coordinates\n      vec2 holoUv = vUv;\n      holoUv.x += sin(vUv.y * 10.0 + time * 0.5) * 0.02;\n      holoUv.y += cos(vUv.x * 10.0 + time * 0.3) * 0.02;\n      vec4 holoColor = texture2D(holoTexture, holoUv);\n      \n      // Sample the rainbow texture with different movement\n      vec2 rainbowUv = vUv;\n      rainbowUv.x += sin(time * 0.2) * 0.1;\n      rainbowUv.y += cos(time * 0.1) * 0.1;\n      vec4 rainbowColor = texture2D(rainbowTexture, rainbowUv);\n      \n      // Calculate view-dependent effect (more visible at glancing angles)\n      vec3 viewDir = normalize(vViewPosition);\n      float fresnel = pow(1.0 - abs(dot(viewDir, vNormal)), 3.0);\n      \n      // Calculate dynamic rainbow based on position and time\n      float rainbowT = vPosition.x * 0.2 + vPosition.y * 0.1 + time * 0.1;\n      vec3 dynamicRainbow = rainbowColor(rainbowT);\n      \n      // Add movement to the effect based on position\n      float movement = sin(vPosition.x * 5.0 + vPosition.y * 3.0 + time * 2.0) * 0.5 + 0.5;\n      \n      // Combine all effects: base color + holo pattern + rainbow + fresnel\n      vec3 finalColor = mix(\n        baseColor,\n        holoColor.rgb * rainbowColor.rgb * dynamicRainbow,\n        fresnel * holoIntensity * movement\n      );\n      \n      // Add extra rainbow lines at strong angles\n      finalColor += dynamicRainbow * fresnel * fresnel * 0.3 * movement;\n      \n      gl_FragColor = vec4(finalColor, 0.7 + fresnel * 0.3);\n    }\n  ",transparent:!0,side:R});return ae.track(r,"material"),r}({baseColor:new S(r.cardColor||"#ff5722"),holoIntensity:r.rarity.length/5});return z(e),()=>{e&&e.dispose()}}),[s,r.rarity,r.cardColor]),e((({clock:e})=>{var t,r;t=L,r=e.getElapsedTime(),t&&t.uniforms&&(t.uniforms.time.value=r),L&&L.uniforms&&(s&&M.current&&L.uniforms.baseTexture&&L.uniforms.baseTexture.value!==M.current&&(L.uniforms.baseTexture.value=M.current),L.uniforms.holoTexture&&!L.uniforms.holoTexture.value&&be("/textures/foil_pattern.jpg",{priority:"low"}).then((e=>{e&&L&&L.uniforms.holoTexture&&(e.wrapS=N,e.wrapT=N,e.repeat.set(3,3),L.uniforms.holoTexture.value=e)})),L.uniforms.rainbowTexture&&!L.uniforms.rainbowTexture.value&&be("/textures/border_pattern.jpg",{priority:"low"}).then((e=>{e&&L&&L.uniforms.rainbowTexture&&(e.wrapS=N,e.wrapT=N,e.repeat.set(2,2),L.uniforms.rainbowTexture.value=e)})))}));const Y=f.useRef([]),H=f.useMemo((()=>{const e=null!==C.current,t=null!==M.current,n=s&&t?M.current:e?C.current:null,a=ve({map:n||void 0,color:n?16777215:Re(r.type),roughness:.5,metalness:.1,envMapIntensity:.3,side:R}),o=ve({color:7817526,roughness:.5,metalness:.1,envMapIntensity:.3,side:R}),i=ve({color:s?13938487:16111470,roughness:.4,metalness:.2,envMapIntensity:.3,side:R}),l=[i,i,i,i,a,o];return Y.current=l,l}),[s,C.current,M.current,r.type]),$=f.useMemo((()=>{if(!s)return null;const e=350,t=new T,n=new Float32Array(1050),a=new Float32Array(1050),o=new Float32Array(e),i=new Float32Array(e),l=new Float32Array(e),c=Re(r.type),u=parseInt(c.substr(1,2),16)/255,d=parseInt(c.substr(3,2),16)/255,p=parseInt(c.substr(5,2),16)/255;for(let r=0;r<e;r++){const t=3*r;let s,c,h,f,m,g;if(r<.7*e){const e=Math.random();e<.25?(s=(Math.random()-.5)*U*.95,c=1.645,h=.02+.08*Math.random()):e<.5?(s=(Math.random()-.5)*U*.95,c=-1.645,h=.02+.08*Math.random()):e<.75?(s=.47*-2.5,c=(Math.random()-.5)*P*.95,h=.02+.08*Math.random()):(s=.47*U,c=(Math.random()-.5)*P*.95,h=.02+.08*Math.random())}else if(r<315){const e=1.5,t=.4*P;Math.random()<.5?(s=(Math.random()-.5)*e,c=(Math.random()<.5?.5:-.5)*t):(s=(Math.random()<.5?.5:-.5)*e,c=(Math.random()-.5)*t),h=.05+.1*Math.random()}else s=(Math.random()-.5)*U*.9,c=(Math.random()-.5)*P*.9,h=.05+.15*Math.random();if(n[t]=s,n[t+1]=c,n[t+2]=h,Math.random()<.3){const e={h:0,s:0,l:0};f=new S(u,d,p).getHSL(e).h+(.1*Math.random()-.05),m=.8+.2*Math.random(),g=.5+.3*Math.random()}else f=Math.random(),m=.7+.3*Math.random(),g=.4+.4*Math.random();const y=(new S).setHSL(f,m,g);a[t]=y.r,a[t+1]=y.g,a[t+2]=y.b,o[r]=.04*Math.random()+.01,i[r]=.5+1.5*Math.random(),l[r]=Math.random()*Math.PI*2}t.setAttribute("position",new W(n,3)),t.setAttribute("color",new W(a,3)),t.setAttribute("size",new W(o,1)),t.setAttribute("speed",new W(i,1)),t.setAttribute("offset",new W(l,1));return{geometry:t,material:new _({uniforms:{time:{value:0},pointTexture:{value:(new v).load("/textures/particle.png")},cardType:{value:new S(u,d,p)}},vertexShader:"\n        attribute float size;\n        attribute float speed;\n        attribute float offset;\n        varying vec3 vColor;\n        uniform float time;\n        uniform vec3 cardType;\n        \n        // Improved noise function for more organic movement\n        float noise(vec2 p) {\n          return sin(p.x * 10.0) * sin(p.y * 10.0) * 0.5 + 0.5;\n        }\n        \n        void main() {\n          vColor = color;\n          \n          // More complex and organic animation\n          vec3 pos = position;\n          \n          // Primary wave motion with individual speed and offset\n          float adjustedTime = time * speed + offset;\n          \n          // Horizontal wave based on position and time\n          pos.x += sin(adjustedTime + position.y * 4.0) * 0.03;\n          \n          // Vertical wave based on position and time with phase shift\n          pos.y += cos(adjustedTime * 0.8 + position.x * 5.0) * 0.03;\n          \n          // Depth oscillation for parallax effect\n          pos.z += sin(adjustedTime * 0.6) * 0.01;\n          \n          // Secondary micro-motion for sparkle effect\n          float noise1 = noise(vec2(position.x * 100.0 + time, position.y * 100.0));\n          float noise2 = noise(vec2(position.y * 100.0 + time, position.x * 100.0));\n          \n          pos.x += noise1 * 0.005;\n          pos.y += noise2 * 0.005;\n          \n          // Dynamic size animation - more organic breathing effect\n          float breathe = sin(adjustedTime * 1.5) * 0.5 + 0.5;\n          float sizeFactor = 0.7 + breathe * 0.6;\n          \n          // Proximity effect: particles get bigger when closer to camera\n          vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n          float distance = -mvPosition.z;\n          \n          // Combine size factors with base size and apply distance scaling\n          float finalSize = size * sizeFactor * (300.0 / distance);\n          \n          gl_PointSize = finalSize;\n          gl_Position = projectionMatrix * mvPosition;\n        }\n      ",fragmentShader:"\n        uniform sampler2D pointTexture;\n        uniform float time;\n        uniform vec3 cardType;\n        varying vec3 vColor;\n        \n        void main() {\n          // Improved texture sampling with sharper center\n          vec4 texColor = texture2D(pointTexture, gl_PointCoord);\n          \n          // Enhanced glow effect\n          vec3 finalColor = vColor;\n          \n          // Pulsating brightness for subtle shimmer\n          float brightness = 0.8 + 0.2 * sin(time * 3.0 + vColor.r * 10.0);\n          finalColor *= brightness;\n          \n          // Add slight color shifting over time for rainbow effect\n          float hueShift = sin(time * 0.2) * 0.1;\n          float r = finalColor.r;\n          finalColor.r = mix(finalColor.r, finalColor.g, hueShift);\n          finalColor.g = mix(finalColor.g, finalColor.b, hueShift);\n          finalColor.b = mix(finalColor.b, r, hueShift);\n          \n          // Mix with card type color for cohesion\n          finalColor = mix(finalColor, cardType, 0.1);\n          \n          // Apply alpha from texture\n          gl_FragColor = vec4(finalColor, texColor.a);\n        }\n      ",blending:B,depthTest:!0,depthWrite:!1,transparent:!0,vertexColors:!0})}}),[s,U,P,r.type]);e((({clock:e})=>{$&&$.material.uniforms&&F.current&&($.material.uniforms.time.value=e.getElapsedTime())})),e((e=>{if(!D.current||i)return;const t=e.clock.elapsedTime,r=D.current;if(r.userData.targetRotationY=void 0!==r.userData.targetRotationY?r.userData.targetRotationY:0,r.userData.targetRotationX=void 0!==r.userData.targetRotationX?r.userData.targetRotationX:0,r.userData.isInteractive=void 0!==r.userData.isInteractive&&r.userData.isInteractive,r.userData.isInteractive)r.rotation.y+=.1*(r.userData.targetRotationY-r.rotation.y),r.rotation.x+=.1*(r.userData.targetRotationX-r.rotation.x),r.rotation.z=.005*Math.sin(.5*t);else{r.position.y=.03*Math.sin(.5*t),r.position.x=.015*Math.sin(.3*t);const e=.05*Math.sin(.4*t),n=.02*Math.sin(.45*t),a=.008*Math.sin(.5*t);r.rotation.y+=.05*(e-r.rotation.y),r.rotation.x+=.05*(n-r.rotation.x),r.rotation.z+=.05*(a-r.rotation.z)}if(F.current){const e=F.current;e.position.copy(r.position),e.position.z+=.01*Math.sin(.7*t)+.01,e.userData.isInteractive?(e.rotation.y+=.12*(e.userData.targetRotationY-e.rotation.y),e.rotation.x+=.12*(e.userData.targetRotationX-e.rotation.x)):e.rotation.copy(r.rotation)}}));const X=f.useRef(null);X.current||(X.current=new q(U,P,.04,2,2,2));const G=f.useMemo((()=>x?t.jsx(ne,{cardData:r,isFullArt:s}):null),[r,s,x]);return t.jsxs(t.Fragment,{children:[t.jsx("ambientLight",{intensity:.8,color:"#ffffff"}),t.jsx("directionalLight",{position:[5,5,5],intensity:.7,color:"#ffffff"}),t.jsxs("mesh",{ref:D,geometry:X.current,material:H,visible:!i,onPointerMove:e=>{if(!D.current||i)return;const t=.25*(e.point.x/5*2),r=.25*(e.point.y/5*2);D.current.userData.targetRotationY=t,D.current.userData.targetRotationX=r,D.current.userData.isInteractive=!0,F.current&&(F.current.userData.targetRotationY=t,F.current.userData.targetRotationX=r,F.current.userData.isInteractive=!0)},onPointerLeave:()=>{D.current&&!i&&(D.current.userData.targetRotationY=0,D.current.userData.targetRotationX=0,D.current.userData.isInteractive=!1,F.current&&(F.current.userData.targetRotationY=0,F.current.userData.targetRotationX=0,F.current.userData.isInteractive=!1))},children:[G,i&&t.jsx(n,{position:[0,0,.1],fontSize:.2,color:"#ffffff",anchorX:"center",anchorY:"middle",children:"Loading..."}),!i&&s&&!b&&I&&t.jsx(n,{position:[0,0,.1],fontSize:.15,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",renderOrder:100,children:"Loading Full Art..."}),!i&&!s&&!x&&t.jsx(n,{position:[0,0,.1],fontSize:.15,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",renderOrder:100,children:"Loading Card Image..."})]})]})},CardTextOverlay:ne,LayeredCard3D:ke,LayeredCardScene:Ie},Symbol.toStringTag,{value:"Module"}));const Pe=m.lazy((()=>d((()=>Promise.resolve().then((()=>Ue))),void 0).then((e=>({default:e.LayeredCardScene}))))),De=({cardData:e,isFullArt:r,onFullArtToggle:n,onGenerateNewArt:a,isGenerating:o=!1,isGlossyCard:s=!0,onGlossyToggle:i,showNormalMap:l=!0,showRoughnessMap:c=!0,showEdgeHighlight:u=!0,showParticles:d=!0,onNormalMapToggle:p,onRoughnessMapToggle:h,onEdgeHighlightToggle:m,onParticlesToggle:g,quality:y="medium",showDebugInfo:x=!1})=>{const[w,b]=f.useState(!1),[v,j]=f.useState(null),[S,C]=f.useState(null),{progress:R}=function(e={}){const{initialDelay:t,autoStart:r,debug:n,onComplete:a,onError:o}={initialDelay:100,autoStart:!0,debug:!1,...e},[s,i]=f.useState({stage:"not-started",percent:0,isLoading:!1,isComplete:!1,error:null}),l=f.useRef([]),c=f.useRef([]),u=f.useRef([]),d=f.useRef([]);f.useEffect((()=>{}),[s,n]),f.useEffect((()=>()=>{d.current.forEach((e=>window.clearTimeout(e)))}),[]);const p=f.useCallback((async()=>{if(!s.isLoading&&!s.isComplete)try{i((e=>({...e,isLoading:!0,stage:"layout-ready",percent:10})));const e=window.setTimeout((async()=>{try{l.current.length>0&&await me(l.current,{priority:"high"}),i((e=>({...e,stage:"basic-textures",percent:30})));const e=window.setTimeout((async()=>{try{c.current.length>0&&await me(c.current,{priority:"normal"}),i((e=>({...e,stage:"full-textures",percent:70})));const e=window.setTimeout((async()=>{try{u.current.length>0&&await me(u.current,{priority:"low"}),i({stage:"complete",percent:100,isLoading:!1,isComplete:!0,error:null}),a&&a()}catch(e){h(e)}}),100);d.current.push(e)}catch(e){h(e)}}),100);d.current.push(e)}catch(e){h(e)}}),t);d.current.push(e)}catch(e){h(e)}}),[s.isLoading,s.isComplete,t,n,a,o]),h=f.useCallback((e=>{i((t=>({...t,isLoading:!1,error:e.message}))),o&&o(e)}),[n,o]),m=f.useCallback(((e=[],t=[],r=[])=>{l.current=[...l.current,...e],c.current=[...c.current,...t],u.current=[...u.current,...r]}),[n]);return f.useEffect((()=>{if(r&&"not-started"===s.stage){const e=window.setTimeout((()=>{p()}),50);d.current.push(e)}}),[r,s.stage,p]),{progress:s,registerTextures:m,startLoading:p}}({autoStart:!0,debug:x,onComplete:()=>b(!1),onError:e=>j(e.message)});f.useEffect((()=>{if(!x)return;const e=()=>{C(ae.getStats())},t=setInterval(e,2e3);return e(),()=>{clearInterval(t)}}),[x]);return f.useEffect((()=>()=>{ae.disposeUnused(0)}),[]),t.jsxs("div",{className:"card-scene-container",children:[w&&t.jsx("div",{className:"card-scene-loading",children:t.jsx("div",{className:"loading-indicator",children:t.jsx("div",{className:"loading-stage",children:"not-started"!==R.stage&&t.jsxs(t.Fragment,{children:["Loading ",R.stage," (",Math.round(R.percent),"%)"]})})})}),v&&t.jsx("div",{className:"card-scene-error",children:t.jsxs("p",{children:["Error: ",v]})}),x&&S&&t.jsxs("div",{className:"card-scene-debug",children:[t.jsxs("div",{children:["Geometries: ",S.geometryCount]}),t.jsxs("div",{children:["Materials: ",S.materialCount]}),t.jsxs("div",{children:["Textures: ",S.textureCount]}),t.jsxs("div",{children:["Memory: ",(S.estimatedMemoryUsage/1048576).toFixed(2),"MB"]})]}),t.jsx("div",{className:"card-scene-canvas",children:t.jsx(f.Suspense,{fallback:t.jsx("div",{className:"card-scene-loading-fallback",children:"Loading 3D components..."}),children:t.jsx(Pe,{cardData:e,isFullArt:r,isLoading:w,showHoloFoil:s,showNormalMap:l,showRoughnessMap:c,showEdgeHighlight:u,showParticles:d,onImageLoadStart:()=>{b(!0),j(null)},onImageLoadComplete:()=>{b(!1)},onImageLoadError:e=>{j(e.message),b(!1)},quality:y})})}),t.jsxs("div",{className:"card-scene-controls",children:[t.jsx("button",{className:"card-toggle-button",onClick:n,disabled:w||o,children:r?"Show Normal Card":"Show Full Art"}),i&&t.jsxs("button",{className:"card-effect-button",onClick:i,disabled:w,children:["Glossy: ",s?"ON":"OFF"]}),p&&t.jsxs("button",{className:"card-effect-button",onClick:p,disabled:w,children:["Normal: ",l?"ON":"OFF"]}),h&&t.jsxs("button",{className:"card-effect-button",onClick:h,disabled:w,children:["Roughness: ",c?"ON":"OFF"]}),m&&t.jsxs("button",{className:"card-effect-button",onClick:m,disabled:w,children:["Edge: ",u?"ON":"OFF"]}),g&&t.jsxs("button",{className:"card-effect-button",onClick:g,disabled:w,children:["Particles: ",d?"ON":"OFF"]}),r&&a&&t.jsx("button",{className:"generate-art-button",onClick:a,disabled:w||o||!e.fullArtImageUrl&&r,children:o?"Generating...":"Generate New Art"})]})]})};function Fe(e,t){return function(){return e.apply(t,arguments)}}const{toString:Le}=Object.prototype,{getPrototypeOf:_e}=Object,ze=(We=Object.create(null),e=>{const t=Le.call(e);return We[t]||(We[t]=t.slice(8,-1).toLowerCase())});var We;const Be=e=>(e=e.toLowerCase(),t=>ze(t)===e),qe=e=>t=>typeof t===e,{isArray:Ye}=Array,He=qe("undefined");const $e=Be("ArrayBuffer");const Xe=qe("string"),Ge=qe("function"),Ve=qe("number"),Je=e=>null!==e&&"object"==typeof e,Ke=e=>{if("object"!==ze(e))return!1;const t=_e(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},Qe=Be("Date"),Ze=Be("File"),et=Be("Blob"),tt=Be("FileList"),rt=Be("URLSearchParams"),[nt,at,ot,st]=["ReadableStream","Request","Response","Headers"].map(Be);function it(e,t,{allOwnKeys:r=!1}={}){if(null==e)return;let n,a;if("object"!=typeof e&&(e=[e]),Ye(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let s;for(n=0;n<o;n++)s=a[n],t.call(null,e[s],s,e)}}function lt(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,a=r.length;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ct="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,ut=e=>!He(e)&&e!==ct;const dt=(pt="undefined"!=typeof Uint8Array&&_e(Uint8Array),e=>pt&&e instanceof pt);var pt;const ht=Be("HTMLFormElement"),ft=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),mt=Be("RegExp"),gt=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};it(r,((r,a)=>{let o;!1!==(o=t(r,a,e))&&(n[a]=o||r)})),Object.defineProperties(e,n)};const yt=Be("AsyncFunction"),xt=(wt="function"==typeof setImmediate,bt=Ge(ct.postMessage),wt?setImmediate:bt?(vt=`axios@${Math.random()}`,jt=[],ct.addEventListener("message",(({source:e,data:t})=>{e===ct&&t===vt&&jt.length&&jt.shift()()}),!1),e=>{jt.push(e),ct.postMessage(vt,"*")}):e=>setTimeout(e));var wt,bt,vt,jt;const St="undefined"!=typeof queueMicrotask?queueMicrotask.bind(ct):"undefined"!=typeof process&&process.nextTick||xt,Ct={isArray:Ye,isArrayBuffer:$e,isBuffer:function(e){return null!==e&&!He(e)&&null!==e.constructor&&!He(e.constructor)&&Ge(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Ge(e.append)&&("formdata"===(t=ze(e))||"object"===t&&Ge(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&$e(e.buffer),t},isString:Xe,isNumber:Ve,isBoolean:e=>!0===e||!1===e,isObject:Je,isPlainObject:Ke,isReadableStream:nt,isRequest:at,isResponse:ot,isHeaders:st,isUndefined:He,isDate:Qe,isFile:Ze,isBlob:et,isRegExp:mt,isFunction:Ge,isStream:e=>Je(e)&&Ge(e.pipe),isURLSearchParams:rt,isTypedArray:dt,isFileList:tt,forEach:it,merge:function e(){const{caseless:t}=ut(this)&&this||{},r={},n=(n,a)=>{const o=t&&lt(r,a)||a;Ke(r[o])&&Ke(n)?r[o]=e(r[o],n):Ke(n)?r[o]=e({},n):Ye(n)?r[o]=n.slice():r[o]=n};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&it(arguments[a],n);return r},extend:(e,t,r,{allOwnKeys:n}={})=>(it(t,((t,n)=>{r&&Ge(t)?e[n]=Fe(t,r):e[n]=t}),{allOwnKeys:n}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let a,o,s;const i={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)s=a[o],n&&!n(s,e,t)||i[s]||(t[s]=e[s],i[s]=!0);e=!1!==r&&_e(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:ze,kindOfTest:Be,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(Ye(e))return e;let t=e.length;if(!Ve(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:ht,hasOwnProperty:ft,hasOwnProp:ft,reduceDescriptors:gt,freezeMethods:e=>{gt(e,((t,r)=>{if(Ge(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];Ge(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach((e=>{r[e]=!0}))};return Ye(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:lt,global:ct,isContextDefined:ut,isSpecCompliantForm:function(e){return!!(e&&Ge(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(Je(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const a=Ye(e)?[]:{};return it(e,((e,t)=>{const o=r(e,n+1);!He(o)&&(a[t]=o)})),t[n]=void 0,a}}return e};return r(e,0)},isAsyncFn:yt,isThenable:e=>e&&(Je(e)||Ge(e))&&Ge(e.then)&&Ge(e.catch),setImmediate:xt,asap:St};function Rt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Ct.inherits(Rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ct.toJSONObject(this.config),code:this.code,status:this.status}}});const Mt=Rt.prototype,Et={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Et[e]={value:e}})),Object.defineProperties(Rt,Et),Object.defineProperty(Mt,"isAxiosError",{value:!0}),Rt.from=(e,t,r,n,a,o)=>{const s=Object.create(Mt);return Ct.toFlatObject(e,s,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Rt.call(s,e.message,t,r,n,a),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};function At(e){return Ct.isPlainObject(e)||Ct.isArray(e)}function Nt(e){return Ct.endsWith(e,"[]")?e.slice(0,-2):e}function Tt(e,t,r){return e?e.concat(t).map((function(e,t){return e=Nt(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}const Ot=Ct.toFlatObject(Ct,{},null,(function(e){return/^is[A-Z]/.test(e)}));function kt(e,t,r){if(!Ct.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=Ct.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Ct.isUndefined(t[e])}))).metaTokens,a=r.visitor||c,o=r.dots,s=r.indexes,i=(r.Blob||"undefined"!=typeof Blob&&Blob)&&Ct.isSpecCompliantForm(t);if(!Ct.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Ct.isDate(e))return e.toISOString();if(!i&&Ct.isBlob(e))throw new Rt("Blob is not supported. Use a Buffer instead.");return Ct.isArrayBuffer(e)||Ct.isTypedArray(e)?i&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,r,a){let i=e;if(e&&!a&&"object"==typeof e)if(Ct.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(Ct.isArray(e)&&function(e){return Ct.isArray(e)&&!e.some(At)}(e)||(Ct.isFileList(e)||Ct.endsWith(r,"[]"))&&(i=Ct.toArray(e)))return r=Nt(r),i.forEach((function(e,n){!Ct.isUndefined(e)&&null!==e&&t.append(!0===s?Tt([r],n,o):null===s?r:r+"[]",l(e))})),!1;return!!At(e)||(t.append(Tt(a,r,o),l(e)),!1)}const u=[],d=Object.assign(Ot,{defaultVisitor:c,convertValue:l,isVisitable:At});if(!Ct.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!Ct.isUndefined(r)){if(-1!==u.indexOf(r))throw Error("Circular reference detected in "+n.join("."));u.push(r),Ct.forEach(r,(function(r,o){!0===(!(Ct.isUndefined(r)||null===r)&&a.call(t,r,Ct.isString(o)?o.trim():o,n,d))&&e(r,n?n.concat(o):[o])})),u.pop()}}(e),t}function It(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Ut(e,t){this._pairs=[],e&&kt(e,this,t)}const Pt=Ut.prototype;function Dt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ft(e,t,r){if(!t)return e;const n=r&&r.encode||Dt;Ct.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let o;if(o=a?a(t,r):Ct.isURLSearchParams(t)?t.toString():new Ut(t,r).toString(n),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}Pt.append=function(e,t){this._pairs.push([e,t])},Pt.toString=function(e){const t=e?function(t){return e.call(this,t,It)}:It;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};class Lt{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ct.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}const _t={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},zt={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Ut,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Wt="undefined"!=typeof window&&"undefined"!=typeof document,Bt="object"==typeof navigator&&navigator||void 0,qt=Wt&&(!Bt||["ReactNative","NativeScript","NS"].indexOf(Bt.product)<0),Yt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Ht=Wt&&window.location.href||"http://localhost",$t={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Wt,hasStandardBrowserEnv:qt,hasStandardBrowserWebWorkerEnv:Yt,navigator:Bt,origin:Ht},Symbol.toStringTag,{value:"Module"})),...zt};function Xt(e){function t(e,r,n,a){let o=e[a++];if("__proto__"===o)return!0;const s=Number.isFinite(+o),i=a>=e.length;if(o=!o&&Ct.isArray(n)?n.length:o,i)return Ct.hasOwnProp(n,o)?n[o]=[n[o],r]:n[o]=r,!s;n[o]&&Ct.isObject(n[o])||(n[o]=[]);return t(e,r,n[o],a)&&Ct.isArray(n[o])&&(n[o]=function(e){const t={},r=Object.keys(e);let n;const a=r.length;let o;for(n=0;n<a;n++)o=r[n],t[o]=e[o];return t}(n[o])),!s}if(Ct.isFormData(e)&&Ct.isFunction(e.entries)){const r={};return Ct.forEachEntry(e,((e,n)=>{t(function(e){return Ct.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,r,0)})),r}return null}const Gt={transitional:_t,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,a=Ct.isObject(e);a&&Ct.isHTMLForm(e)&&(e=new FormData(e));if(Ct.isFormData(e))return n?JSON.stringify(Xt(e)):e;if(Ct.isArrayBuffer(e)||Ct.isBuffer(e)||Ct.isStream(e)||Ct.isFile(e)||Ct.isBlob(e)||Ct.isReadableStream(e))return e;if(Ct.isArrayBufferView(e))return e.buffer;if(Ct.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return kt(e,new $t.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return $t.isNode&&Ct.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=Ct.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return kt(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||n?(t.setContentType("application/json",!1),function(e,t,r){if(Ct.isString(e))try{return(t||JSON.parse)(e),Ct.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Gt.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(Ct.isResponse(e)||Ct.isReadableStream(e))return e;if(e&&Ct.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(a){if(r){if("SyntaxError"===a.name)throw Rt.from(a,Rt.ERR_BAD_RESPONSE,this,null,this.response);throw a}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$t.classes.FormData,Blob:$t.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ct.forEach(["delete","get","head","post","put","patch"],(e=>{Gt.headers[e]={}}));const Vt=Ct.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Jt=Symbol("internals");function Kt(e){return e&&String(e).trim().toLowerCase()}function Qt(e){return!1===e||null==e?e:Ct.isArray(e)?e.map(Qt):String(e)}function Zt(e,t,r,n,a){return Ct.isFunction(n)?n.call(this,t,r):(a&&(t=r),Ct.isString(t)?Ct.isString(n)?-1!==t.indexOf(n):Ct.isRegExp(n)?n.test(t):void 0:void 0)}let er=class{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function a(e,t,r){const a=Kt(t);if(!a)throw new Error("header name must be a non-empty string");const o=Ct.findKey(n,a);(!o||void 0===n[o]||!0===r||void 0===r&&!1!==n[o])&&(n[o||t]=Qt(e))}const o=(e,t)=>Ct.forEach(e,((e,r)=>a(e,r,t)));if(Ct.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Ct.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const t={};let r,n,a;return e&&e.split("\n").forEach((function(e){a=e.indexOf(":"),r=e.substring(0,a).trim().toLowerCase(),n=e.substring(a+1).trim(),!r||t[r]&&Vt[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)})),t})(e),t);else if(Ct.isHeaders(e))for(const[s,i]of e.entries())a(i,s,r);else null!=e&&a(t,e,r);return this}get(e,t){if(e=Kt(e)){const r=Ct.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(Ct.isFunction(t))return t.call(this,e,r);if(Ct.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Kt(e)){const r=Ct.findKey(this,e);return!(!r||void 0===this[r]||t&&!Zt(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function a(e){if(e=Kt(e)){const a=Ct.findKey(r,e);!a||t&&!Zt(0,r[a],a,t)||(delete r[a],n=!0)}}return Ct.isArray(e)?e.forEach(a):a(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const a=t[r];e&&!Zt(0,this[a],a,e,!0)||(delete this[a],n=!0)}return n}normalize(e){const t=this,r={};return Ct.forEach(this,((n,a)=>{const o=Ct.findKey(r,a);if(o)return t[o]=Qt(n),void delete t[a];const s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,r)=>t.toUpperCase()+r))}(a):String(a).trim();s!==a&&delete t[a],t[s]=Qt(n),r[s]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ct.forEach(this,((r,n)=>{null!=r&&!1!==r&&(t[n]=e&&Ct.isArray(r)?r.join(", "):r)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach((e=>r.set(e))),r}static accessor(e){const t=(this[Jt]=this[Jt]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=Kt(e);t[n]||(!function(e,t){const r=Ct.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+r,{value:function(e,r,a){return this[n].call(this,t,e,r,a)},configurable:!0})}))}(r,e),t[n]=!0)}return Ct.isArray(e)?e.forEach(n):n(e),this}};function tr(e,t){const r=this||Gt,n=t||r,a=er.from(n.headers);let o=n.data;return Ct.forEach(e,(function(e){o=e.call(r,o,a.normalize(),t?t.status:void 0)})),a.normalize(),o}function rr(e){return!(!e||!e.__CANCEL__)}function nr(e,t,r){Rt.call(this,null==e?"canceled":e,Rt.ERR_CANCELED,t,r),this.name="CanceledError"}function ar(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new Rt("Request failed with status code "+r.status,[Rt.ERR_BAD_REQUEST,Rt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}er.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ct.reduceDescriptors(er.prototype,(({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[r]=e}}})),Ct.freezeMethods(er),Ct.inherits(nr,Rt,{__CANCEL__:!0});const or=(e,t,r=3)=>{let n=0;const a=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a,o=0,s=0;return t=void 0!==t?t:1e3,function(i){const l=Date.now(),c=n[s];a||(a=l),r[o]=i,n[o]=l;let u=s,d=0;for(;u!==o;)d+=r[u++],u%=e;if(o=(o+1)%e,o===s&&(s=(s+1)%e),l-a<t)return;const p=c&&l-c;return p?Math.round(1e3*d/p):void 0}}(50,250);return function(e,t){let r,n,a=0,o=1e3/t;const s=(t,o=Date.now())=>{a=o,r=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),i=t-a;i>=o?s(e,t):(r=e,n||(n=setTimeout((()=>{n=null,s(r)}),o-i)))},()=>r&&s(r)]}((r=>{const o=r.loaded,s=r.lengthComputable?r.total:void 0,i=o-n,l=a(i);n=o;e({loaded:o,total:s,progress:s?o/s:void 0,bytes:i,rate:l||void 0,estimated:l&&s&&o<=s?(s-o)/l:void 0,event:r,lengthComputable:null!=s,[t?"download":"upload"]:!0})}),r)},sr=(e,t)=>{const r=null!=e;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},ir=e=>(...t)=>Ct.asap((()=>e(...t))),lr=$t.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,$t.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL($t.origin),$t.navigator&&/(msie|trident)/i.test($t.navigator.userAgent)):()=>!0,cr=$t.hasStandardBrowserEnv?{write(e,t,r,n,a,o){const s=[e+"="+encodeURIComponent(t)];Ct.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Ct.isString(n)&&s.push("path="+n),Ct.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ur(e,t,r){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&n||0==r?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const dr=e=>e instanceof er?{...e}:e;function pr(e,t){t=t||{};const r={};function n(e,t,r,n){return Ct.isPlainObject(e)&&Ct.isPlainObject(t)?Ct.merge.call({caseless:n},e,t):Ct.isPlainObject(t)?Ct.merge({},t):Ct.isArray(t)?t.slice():t}function a(e,t,r,a){return Ct.isUndefined(t)?Ct.isUndefined(e)?void 0:n(void 0,e,0,a):n(e,t,0,a)}function o(e,t){if(!Ct.isUndefined(t))return n(void 0,t)}function s(e,t){return Ct.isUndefined(t)?Ct.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function i(r,a,o){return o in t?n(r,a):o in e?n(void 0,r):void 0}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:i,headers:(e,t,r)=>a(dr(e),dr(t),0,!0)};return Ct.forEach(Object.keys(Object.assign({},e,t)),(function(n){const o=l[n]||a,s=o(e[n],t[n],n);Ct.isUndefined(s)&&o!==i||(r[n]=s)})),r}const hr=e=>{const t=pr({},e);let r,{data:n,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:s,headers:i,auth:l}=t;if(t.headers=i=er.from(i),t.url=Ft(ur(t.baseURL,t.url),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Ct.isFormData(n))if($t.hasStandardBrowserEnv||$t.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(r=i.getContentType())){const[e,...t]=r?r.split(";").map((e=>e.trim())).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if($t.hasStandardBrowserEnv&&(a&&Ct.isFunction(a)&&(a=a(t)),a||!1!==a&&lr(t.url))){const e=o&&s&&cr.read(s);e&&i.set(o,e)}return t},fr="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){const n=hr(e);let a=n.data;const o=er.from(n.headers).normalize();let s,i,l,c,u,{responseType:d,onUploadProgress:p,onDownloadProgress:h}=n;function f(){c&&c(),u&&u(),n.cancelToken&&n.cancelToken.unsubscribe(s),n.signal&&n.signal.removeEventListener("abort",s)}let m=new XMLHttpRequest;function g(){if(!m)return;const n=er.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());ar((function(e){t(e),f()}),(function(e){r(e),f()}),{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:n,config:e,request:m}),m=null}m.open(n.method.toUpperCase(),n.url,!0),m.timeout=n.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(r(new Rt("Request aborted",Rt.ECONNABORTED,e,m)),m=null)},m.onerror=function(){r(new Rt("Network Error",Rt.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const a=n.transitional||_t;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),r(new Rt(t,a.clarifyTimeoutError?Rt.ETIMEDOUT:Rt.ECONNABORTED,e,m)),m=null},void 0===a&&o.setContentType(null),"setRequestHeader"in m&&Ct.forEach(o.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),Ct.isUndefined(n.withCredentials)||(m.withCredentials=!!n.withCredentials),d&&"json"!==d&&(m.responseType=n.responseType),h&&([l,u]=or(h,!0),m.addEventListener("progress",l)),p&&m.upload&&([i,c]=or(p),m.upload.addEventListener("progress",i),m.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(s=t=>{m&&(r(!t||t.type?new nr(null,e,m):t),m.abort(),m=null)},n.cancelToken&&n.cancelToken.subscribe(s),n.signal&&(n.signal.aborted?s():n.signal.addEventListener("abort",s)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);y&&-1===$t.protocols.indexOf(y)?r(new Rt("Unsupported protocol "+y+":",Rt.ERR_BAD_REQUEST,e)):m.send(a||null)}))},mr=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,n=new AbortController;const a=function(e){if(!r){r=!0,s();const t=e instanceof Error?e:this.reason;n.abort(t instanceof Rt?t:new nr(t instanceof Error?t.message:t))}};let o=t&&setTimeout((()=>{o=null,a(new Rt(`timeout ${t} of ms exceeded`,Rt.ETIMEDOUT))}),t);const s=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((e=>e.addEventListener("abort",a)));const{signal:i}=n;return i.unsubscribe=()=>Ct.asap(s),i}},gr=function*(e,t){let r=e.byteLength;if(r<t)return void(yield e);let n,a=0;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},yr=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;yield r}}finally{await t.cancel()}},xr=(e,t,r,n)=>{const a=async function*(e,t){for await(const r of yr(e))yield*gr(r,t)}(e,t);let o,s=0,i=e=>{o||(o=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await a.next();if(t)return i(),void e.close();let o=n.byteLength;if(r){let e=s+=o;r(e)}e.enqueue(new Uint8Array(n))}catch(t){throw i(t),t}},cancel:e=>(i(e),a.return())},{highWaterMark:2})},wr="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,br=wr&&"function"==typeof ReadableStream,vr=wr&&("function"==typeof TextEncoder?(jr=new TextEncoder,e=>jr.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var jr;const Sr=(e,...t)=>{try{return!!e(...t)}catch(r){return!1}},Cr=br&&Sr((()=>{let e=!1;const t=new Request($t.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Rr=br&&Sr((()=>Ct.isReadableStream(new Response("").body))),Mr={stream:Rr&&(e=>e.body)};var Er;wr&&(Er=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!Mr[e]&&(Mr[e]=Ct.isFunction(Er[e])?t=>t[e]():(t,r)=>{throw new Rt(`Response type '${e}' is not supported`,Rt.ERR_NOT_SUPPORT,r)})})));const Ar=async(e,t)=>{const r=Ct.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Ct.isBlob(e))return e.size;if(Ct.isSpecCompliantForm(e)){const t=new Request($t.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Ct.isArrayBufferView(e)||Ct.isArrayBuffer(e)?e.byteLength:(Ct.isURLSearchParams(e)&&(e+=""),Ct.isString(e)?(await vr(e)).byteLength:void 0)})(t):r},Nr={http:null,xhr:fr,fetch:wr&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:o,timeout:s,onDownloadProgress:i,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:p}=hr(e);c=c?(c+"").toLowerCase():"text";let h,f=mr([a,o&&o.toAbortSignal()],s);const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(l&&Cr&&"get"!==r&&"head"!==r&&0!==(g=await Ar(u,n))){let e,r=new Request(t,{method:"POST",body:n,duplex:"half"});if(Ct.isFormData(n)&&(e=r.headers.get("content-type"))&&u.setContentType(e),r.body){const[e,t]=sr(g,or(ir(l)));n=xr(r.body,65536,e,t)}}Ct.isString(d)||(d=d?"include":"omit");const a="credentials"in Request.prototype;h=new Request(t,{...p,signal:f,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:a?d:void 0});let o=await fetch(h);const s=Rr&&("stream"===c||"response"===c);if(Rr&&(i||s&&m)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=o[t]}));const t=Ct.toFiniteNumber(o.headers.get("content-length")),[r,n]=i&&sr(t,or(ir(i),!0))||[];o=new Response(xr(o.body,65536,r,(()=>{n&&n(),m&&m()})),e)}c=c||"text";let y=await Mr[Ct.findKey(Mr,c)||"text"](o,e);return!s&&m&&m(),await new Promise(((t,r)=>{ar(t,r,{data:y,headers:er.from(o.headers),status:o.status,statusText:o.statusText,config:e,request:h})}))}catch(y){if(m&&m(),y&&"TypeError"===y.name&&/fetch/i.test(y.message))throw Object.assign(new Rt("Network Error",Rt.ERR_NETWORK,e,h),{cause:y.cause||y});throw Rt.from(y,y&&y.code,e,h)}})};Ct.forEach(Nr,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(r){}Object.defineProperty(e,"adapterName",{value:t})}}));const Tr=e=>`- ${e}`,Or=e=>Ct.isFunction(e)||null===e||!1===e,kr=e=>{e=Ct.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let o=0;o<t;o++){let t;if(r=e[o],n=r,!Or(r)&&(n=Nr[(t=String(r)).toLowerCase()],void 0===n))throw new Rt(`Unknown adapter '${t}'`);if(n)break;a[t||"#"+o]=n}if(!n){const e=Object.entries(a).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new Rt("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Tr).join("\n"):" "+Tr(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n};function Ir(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nr(null,e)}function Ur(e){Ir(e),e.headers=er.from(e.headers),e.data=tr.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return kr(e.adapter||Gt.adapter)(e).then((function(t){return Ir(e),t.data=tr.call(e,e.transformResponse,t),t.headers=er.from(t.headers),t}),(function(t){return rr(t)||(Ir(e),t&&t.response&&(t.response.data=tr.call(e,e.transformResponse,t.response),t.response.headers=er.from(t.response.headers))),Promise.reject(t)}))}const Pr="1.8.2",Dr={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Dr[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));const Fr={};Dr.transitional=function(e,t,r){return(n,a,o)=>{if(!1===e)throw new Rt(function(e,t){return"[Axios v1.8.2] Transitional option '"+e+"'"+t+(r?". "+r:"")}(a," has been removed"+(t?" in "+t:"")),Rt.ERR_DEPRECATED);return t&&!Fr[a]&&(Fr[a]=!0),!e||e(n,a,o)}},Dr.spelling=function(e){return(e,t)=>!0};const Lr={assertOptions:function(e,t,r){if("object"!=typeof e)throw new Rt("options must be an object",Rt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const o=n[a],s=t[o];if(s){const t=e[o],r=void 0===t||s(t,o,e);if(!0!==r)throw new Rt("option "+o+" must be "+r,Rt.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new Rt("Unknown option "+o,Rt.ERR_BAD_OPTION)}},validators:Dr},_r=Lr.validators;let zr=class{constructor(e){this.defaults=e,this.interceptors={request:new Lt,response:new Lt}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(n){}}throw r}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=pr(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:a}=t;void 0!==r&&Lr.assertOptions(r,{silentJSONParsing:_r.transitional(_r.boolean),forcedJSONParsing:_r.transitional(_r.boolean),clarifyTimeoutError:_r.transitional(_r.boolean)},!1),null!=n&&(Ct.isFunction(n)?t.paramsSerializer={serialize:n}:Lr.assertOptions(n,{encode:_r.function,serialize:_r.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Lr.assertOptions(t,{baseUrl:_r.spelling("baseURL"),withXsrfToken:_r.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&Ct.merge(a.common,a[t.method]);a&&Ct.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete a[e]})),t.headers=er.concat(o,a);const s=[];let i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!i){const e=[Ur.bind(this),void 0];for(e.unshift.apply(e,s),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=s.length;let p=t;for(d=0;d<u;){const e=s[d++],t=s[d++];try{p=e(p)}catch(h){t.call(this,h);break}}try{c=Ur.call(this,p)}catch(h){return Promise.reject(h)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return Ft(ur((e=pr(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Ct.forEach(["delete","get","head","options"],(function(e){zr.prototype[e]=function(t,r){return this.request(pr(r||{},{method:e,url:t,data:(r||{}).data}))}})),Ct.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,a){return this.request(pr(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}zr.prototype[e]=t(),zr.prototype[e+"Form"]=t(!0)}));const Wr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wr).forEach((([e,t])=>{Wr[t]=e}));const Br=function e(t){const r=new zr(t),n=Fe(zr.prototype.request,r);return Ct.extend(n,zr.prototype,r,{allOwnKeys:!0}),Ct.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return e(pr(t,r))},n}(Gt);Br.Axios=zr,Br.CanceledError=nr,Br.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const r=this;this.promise.then((e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e,n,a){r.reason||(r.reason=new nr(e,n,a),t(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e((function(e){t=e})),cancel:t}}},Br.isCancel=rr,Br.VERSION=Pr,Br.toFormData=kt,Br.AxiosError=Rt,Br.Cancel=Br.CanceledError,Br.all=function(e){return Promise.all(e)},Br.spread=function(e){return function(t){return e.apply(null,t)}},Br.isAxiosError=function(e){return Ct.isObject(e)&&!0===e.isAxiosError},Br.mergeConfig=pr,Br.AxiosHeaders=er,Br.formToJSON=e=>Xt(Ct.isHTMLForm(e)?new FormData(e):e),Br.getAdapter=kr,Br.HttpStatusCode=Wr,Br.default=Br;const{Axios:qr,AxiosError:Yr,CanceledError:Hr,isCancel:$r,CancelToken:Xr,VERSION:Gr,all:Vr,Cancel:Jr,isAxiosError:Kr,spread:Qr,toFormData:Zr,AxiosHeaders:en,HttpStatusCode:tn,formToJSON:rn,getAdapter:nn,mergeConfig:an}=Br,on={baseURL:"/api",timeout:3e4,headers:{"Content-Type":"application/json"}};function sn(e={}){const t={...on,...e,headers:{...on.headers,...e.headers}},r=Br.create(t);return r.interceptors.response.use((e=>e),(e=>(Br.isAxiosError(e)&&(504===e.response?.status||e.message&&e.message.includes("ECONNREFUSED")),Promise.reject(e)))),r}const ln=sn(),cn={get:ln.get,post:ln.post,put:ln.put,delete:ln.delete,patch:ln.patch,getInstance:(e={})=>sn(e),instance:ln},un="/cardback.jpg";async function dn(e){try{const t=await cn.get(`/card/${e}`);return t.data.nftImage,t.data.fullArtProcessing,t.data}catch(t){throw t}}function pn(e,t){const r=e.cardDetails||{cardName:"Generated Character",typeIcon:"🔥",hp:"100 HP",move:{name:"Magic Attack",atk:"40"},weakness:"💧 x2",resistance:"🪨 -20",retreatCost:"🌟",rarity:"★★"};let n=null;if(e.fullArtUrl&&e.fullArtUrl.includes("cdn.midjourney.com"))n=e.fullArtUrl;else if(e.temporary_image_urls&&e.temporary_image_urls.length>0){const t=e.temporary_image_urls.find((e=>e.includes("cdn.midjourney.com")));n=t||e.temporary_image_urls[0]}else e.fullArtUrl&&(n=e.fullArtUrl);const a=r.move||{name:"Basic Attack",atk:"30"};let o=e.nftImage;o||(o=un);const s=t||e.tokenId||"Unknown",i=e.nftTraits?`Azuki #${s} - ${e.nftTraits.map((e=>`${e.trait_type}: ${e.value}`)).join(", ")}`:`Azuki #${s}`;return{cardName:r.cardName||"Unknown Card",hp:r.hp||"100 HP",type:r.typeIcon||"🔥",move:{name:a.name||"Basic Attack",damage:a.atk||"30"},weakness:r.weakness||"💧 x2",resistance:r.resistance||"🪨 -20",retreatCost:r.retreatCost||"🌟",rarity:r.rarity||"★",normalImageUrl:o,...n?{fullArtImageUrl:n}:{},...e.allImageUrls&&e.allImageUrls.length>0?{allArtImageUrls:e.allImageUrls}:e.temporary_image_urls&&e.temporary_image_urls.length>0?{allArtImageUrls:e.temporary_image_urls}:{},cardColor:e.cardColor||"#ff5722",traits:i}}const hn=e=>{const[t,r]=f.useState(null),[n,a]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,u]=f.useState(!1),[d,p]=f.useState(!1),h=f.useCallback((async()=>{if(e){a(!0),l(null);try{const t=await dn(e);if(!t.success)throw new Error(t.error||"Failed to fetch card data");t.nftImage;const n=pn(t,e);r(n),t.fullArtProcessing&&u(!0)}catch(t){l(t instanceof Error?t.message:"An unknown error occurred")}finally{a(!1)}}}),[e]),m=f.useCallback((async()=>{if(e&&c)try{const a=await async function(e){try{const t=await cn.get(`/debug/image/${e}`);return t.data.progress,t.data.imageStatus,t.data.fullArtUrl,t.data}catch(i){if("response"in i&&404===i.response?.status)return{success:!1,error:"No image found for this token ID"};throw i}}(e);if(!a.success)return;a&&a.progress;const o="complete"===a.imageStatus||!0===a.completed||!1===a.processing&&a.fullArtUrl||100===a.progress&&a.fullArtUrl;if(a.fullArtUrl)if(t){const e={...t,fullArtImageUrl:a.fullArtUrl,...a.allImageUrls&&a.allImageUrls.length>0?{allArtImageUrls:a.allImageUrls}:{}};r(e),o&&(u(!1),p(!0))}else try{const t=await dn(e);if(t.success){const n=pn({...t,fullArtUrl:a.fullArtUrl},e);r(n),u(!1)}}catch(n){}else o&&u(!1)}catch(a){}}),[e,c,t]),g=f.useCallback((async()=>{if(e){s(!0),l(null);try{const t=await async function(e){try{const t=cn.getInstance({timeout:12e4});return(await t.post(`/v2/generate-art/${e}`)).data}catch(i){throw i}}(e);if(!t.success)throw new Error(t.error||"Failed to generate new art");t.processingStarted?(u(!0),alert("Art generation has been started in the background. The card will update automatically when ready. You can check the status in the gallery.")):t.message&&t.message.includes("already in progress")?(u(!0),alert("Art generation is already in progress. The card will update automatically when ready. You can check the status in the gallery.")):await h()}catch(t){const e=t instanceof Error?t.message:"Failed to generate new art";l(e),(e.includes("timeout")||e.includes("timed out"))&&(alert("The art generation request is taking longer than expected. The process will continue in the background and you can check the gallery later for the new art."),u(!0))}finally{s(!1)}}}),[e,h]);return f.useEffect((()=>{e&&(p(!1),a(!0),h())}),[e,h]),f.useEffect((()=>{if(!c)return;m();const e=setInterval(m,4e3);return()=>{clearInterval(e)}}),[c,m]),{cardData:t,isLoading:n,isGenerating:o,isPolling:c,error:i,fullArtReady:d,setFullArtReady:p,refreshCardData:h,generateNewArtForCard:g}};const fn=({initialPage:e=1,initialLimit:t=12,initialFilter:r="all",initialSearch:n=""}={})=>{const[a,o]=f.useState([]),[s,i]=f.useState({page:e,limit:t,totalItems:0,totalPages:1}),[l,c]=f.useState(r),[u,d]=f.useState(n),[p,h]=f.useState(!1),[m,g]=f.useState(null),y=f.useCallback((async()=>{h(!0),g(null);try{const e=await async function(e=1,t=12,r="all",n=""){try{const o=new URLSearchParams({page:e.toString(),limit:t.toString(),filter:r,search:n}),s=await cn.get(`/gallery?${o.toString()}`);return s.data.data&&(s.data.data=(a=s.data.data)&&0!==a.length?a.map((e=>{let t={...e};if(e.allImageUrls&&e.allImageUrls.length>0&&(t.quadrants=e.allImageUrls.map(((e,t)=>({url:e,number:t+1}))),t.hasMultipleVariants=!0),!t.url&&t.quadrants&&t.quadrants.length>0&&(t.url=t.quadrants[0].url),!t.tokenId&&t.cacheKey){const e=t.cacheKey.match(/^(\d+)_/);e&&(t.tokenId=e[1])}return t})):[]),s.data}catch(m){throw m}var a}(s.page,s.limit,l,u);if(!e||!e.data)throw new Error("Invalid gallery response format");o(e.data),i({page:e.pagination.page,limit:e.pagination.limit,totalItems:e.pagination.totalItems,totalPages:e.pagination.totalPages||1})}catch(e){g(e instanceof Error?e.message:"Failed to fetch gallery data"),o([])}finally{h(!1)}}),[s.page,s.limit,l,u]),x=f.useCallback((e=>{e<1||e>s.totalPages||i((t=>({...t,page:e})))}),[s.totalPages]),w=f.useCallback((()=>{s.page<s.totalPages&&i((e=>({...e,page:e.page+1})))}),[s]),b=f.useCallback((()=>{s.page>1&&i((e=>({...e,page:e.page-1})))}),[s]),v=f.useCallback((e=>{i((t=>({...t,limit:e,page:1})))}),[]),j=f.useCallback((e=>{c(e),i((e=>({...e,page:1})))}),[]),S=f.useCallback((e=>{d(e),i((e=>({...e,page:1})))}),[]),C=f.useCallback((()=>{y()}),[y]);return f.useEffect((()=>{y()}),[s.page,s.limit,l,u,y]),{items:a,pagination:s,filter:l,search:u,isLoading:p,error:m,goToPage:x,nextPage:w,prevPage:b,changeLimit:v,changeFilter:j,updateSearch:S,refreshGallery:C}},mn=f.memo((({item:e,onClick:r})=>{const n=new Date(e.timestamp).toLocaleDateString()+" "+new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),a=e=>{const t=we(e),r=(e=>e.includes("theapi.app")||e.includes("img.theapi.app"))(e),n=Date.now();return e?r?xe(e,!1):t?`/api/proxy-image?url=${encodeURIComponent(e)}&midjourney=true&timestamp=${n}`:xe(e,!1):"https://placehold.co/300x400/333/FFF?text=Missing+Image"};return t.jsxs("div",{className:"gallery-item",onClick:()=>{r(e.tokenId)},children:[e.quadrants&&e.quadrants.length>0?t.jsxs("div",{className:"quadrant-grid",children:[e.quadrants.slice(0,4).map(((r,n)=>(!r.url||r.url.substring(0,50),t.jsx("img",{src:r.url?a(r.url):`https://placehold.co/300x400/333/FFF?text=Variant+${n+1}`,alt:`Azuki #${e.tokenId} Variant ${n+1}`,className:"quadrant-image",loading:"lazy",onError:e=>{const t=e.target;t.onerror=null,t.src=`https://placehold.co/300x400/333/FFF?text=Variant+${n+1}`}},`${e.tokenId}-variant-${n}`)))),e.quadrants.length<4&&Array.from({length:4-e.quadrants.length}).map(((r,n)=>t.jsxs("div",{className:"quadrant-placeholder",style:{backgroundColor:"#333",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"14px"},children:["No Variant ",n+e.quadrants.length+1]},`${e.tokenId}-placeholder-${n}`)))]}):t.jsx("img",{src:a(e.url),alt:`Azuki #${e.tokenId} Full Art`,className:"full-art-image",loading:"lazy",onError:t=>{const r=t.target;r.onerror=null,r.src=`https://placehold.co/300x400/333/FFF?text=Azuki+%23${e.tokenId}`}}),t.jsxs("div",{className:"gallery-item-info",children:[t.jsxs("span",{className:"gallery-item-id",children:["Azuki #",e.tokenId]}),t.jsx("span",{className:"gallery-item-date",children:n}),e.isFallback&&t.jsx("span",{className:"gallery-item-fallback",children:"Fallback"}),e.version>1&&t.jsxs("span",{className:"gallery-item-version",children:["v",e.version]}),e.quadrants&&e.quadrants.length>1&&t.jsxs("span",{className:"gallery-item-variants",children:[e.quadrants.length," variants"]})]})]})})),gn=({currentPage:e,totalPages:r,onNextPage:n,onPrevPage:a,disabled:o})=>t.jsxs("div",{className:"gallery-pagination",children:[t.jsx("button",{className:"pagination-button",onClick:a,disabled:e<=1||o,children:"« Previous"}),t.jsxs("span",{className:"pagination-info",children:["Page ",e," of ",r]}),t.jsx("button",{className:"pagination-button",onClick:n,disabled:e>=r||o,children:"Next »"})]}),yn=({currentFilter:e,searchValue:r,onFilterChange:n,onSearchChange:a})=>t.jsxs("div",{className:"gallery-filters",children:[t.jsx("div",{className:"search-container",children:t.jsx("input",{type:"text",className:"gallery-search",placeholder:"Search by Azuki ID...",value:r,onChange:a})}),t.jsx("div",{className:"filter-buttons",children:[{id:"all",label:"All"},{id:"recent",label:"Recent"},{id:"popular",label:"Popular"}].map((r=>t.jsx("button",{className:"filter-button "+(e===r.id?"active":""),onClick:()=>n(r.id),children:r.label},r.id)))})]}),xn=({onSelectItem:e,onClose:r})=>{const[n,a]=f.useState(""),{items:o,pagination:s,filter:i,isLoading:l,error:c,nextPage:u,prevPage:d,changeFilter:p,updateSearch:h,refreshGallery:m}=fn();f.useEffect((()=>{const e=setTimeout((()=>{h(n)}),500);return()=>clearTimeout(e)}),[n,h]);const g=t=>{e(t)};return t.jsx("div",{className:"gallery-modal",children:t.jsxs("div",{className:"gallery-content",children:[t.jsxs("div",{className:"gallery-header",children:[t.jsx("h2",{children:"Full Art Gallery"}),t.jsx("button",{className:"gallery-close-button",onClick:r,children:"×"})]}),t.jsxs("div",{className:"gallery-body",children:[t.jsx(yn,{currentFilter:i,searchValue:n,onFilterChange:e=>{p(e)},onSearchChange:e=>{a(e.target.value)}}),l?t.jsxs("div",{className:"gallery-loading",children:[t.jsx("div",{className:"gallery-spinner"}),t.jsx("p",{children:"Loading gallery..."})]}):c?t.jsxs("div",{className:"gallery-error",children:[t.jsx("p",{children:c}),t.jsx("button",{className:"gallery-retry-button",onClick:m,children:"Retry"})]}):0===o.length?t.jsx("div",{className:"gallery-empty",children:t.jsx("p",{children:"No images found. Generate some cards first!"})}):t.jsx("div",{className:"gallery-grid",children:o.map((e=>t.jsx(mn,{item:e,onClick:g},`${e.tokenId}-${e.timestamp}`)))}),t.jsx(gn,{currentPage:s.page,totalPages:s.totalPages,onNextPage:u,onPrevPage:d,disabled:l})]}),t.jsxs("div",{className:"gallery-footer",children:[t.jsx("button",{className:"gallery-refresh-button",onClick:m,disabled:l,children:"Refresh Gallery"}),t.jsx("button",{className:"gallery-close-button-text",onClick:r,children:"Close Gallery"})]})]})})},wn=()=>{const{id:e}=g(),r=y(),[n,a]=f.useState(e||"1834"),[o,s]=f.useState(e||"1834"),[i,l]=f.useState(!1),[c,u]=f.useState(!0),[d,p]=f.useState(!1),{cardData:h,isLoading:m,isGenerating:x,isPolling:w,error:b,fullArtReady:v,setFullArtReady:j,refreshCardData:S,generateNewArtForCard:C}=hn(n),R={cardName:"Enter an Azuki ID",hp:"100 HP",type:"🔥",move:{name:"Flame Dance",damage:"40"},weakness:"💧 x2",resistance:"🪨 -20",retreatCost:"🌟",rarity:"★★★",normalImageUrl:un,fullArtImageUrl:null,cardColor:"#ff5722",traits:"Enter an Azuki ID to generate a card"};f.useEffect((()=>{e&&e!==n&&(a(e),s(e))}),[e]),f.useEffect((()=>{v&&h?.fullArtImageUrl&&(l(!0),j(!1))}),[v,h?.fullArtImageUrl]);const[M,E]=f.useState(!0),[A,N]=f.useState(!0),[T,O]=f.useState(!0),[k,I]=f.useState(!0);return t.jsxs("div",{className:"home-container",children:[t.jsxs("header",{className:"home-header",children:[t.jsx("h1",{children:"Azuki TCG Generator"}),t.jsx("span",{className:"version-badge",children:"v1.0.0"}),w&&t.jsxs("div",{className:"global-status-indicator",children:[t.jsx("span",{className:"status-spinner"}),t.jsx("span",{children:"AI generating art..."})]})]}),t.jsx("main",{className:"home-main",children:t.jsxs("section",{className:"card-section",children:[t.jsxs("form",{className:"card-form",onSubmit:e=>{e.preventDefault();const t=parseInt(o.trim());if(isNaN(t)||t<0||t>9999)return;const n=t.toString();a(n),r(`/nft/${n}`,{replace:!0})},children:[t.jsxs("div",{className:"input-group",children:[t.jsx("input",{type:"number",id:"token-id",value:o,onChange:e=>{s(e.target.value)},placeholder:"Enter Azuki ID (0-9999)",min:"0",max:"9999",required:!0}),t.jsx("button",{type:"submit",className:"primary-button "+(m?"loading-button":""),disabled:m||x,children:m?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"button-spinner"}),t.jsx("span",{children:"Loading..."})]}):"Generate Card"})]}),t.jsxs("div",{className:"action-buttons",children:[t.jsxs("button",{type:"button",className:"secondary-button",onClick:()=>{p(!0)},disabled:m||x,children:[t.jsx("span",{className:"button-icon",children:"🖼️"})," Gallery"]}),x&&t.jsxs("div",{className:"generating-status",children:[t.jsx("span",{className:"status-spinner"}),t.jsx("span",{children:"Generating card art, please wait..."})]})]})]}),t.jsxs("div",{className:"card-display",children:[b?t.jsxs("div",{className:"error-message",children:[t.jsx("div",{className:"error-icon",children:"❌"}),t.jsx("p",{children:b}),t.jsx("button",{onClick:()=>n&&S(),className:"retry-button",children:"Retry"})]}):t.jsx(De,{cardData:h||R,isFullArt:i,onFullArtToggle:()=>{l(!i)},onGenerateNewArt:()=>{n&&window.confirm("Generating new art may take some time (up to 1-2 minutes or more). The button will show 'Generating...' while it's processing. Would you like to continue?")&&(l(!1),C())},isGenerating:x,isGlossyCard:c,onGlossyToggle:()=>{u(!c)},showNormalMap:M,showRoughnessMap:A,showEdgeHighlight:T,showParticles:k,onNormalMapToggle:()=>{E(!M)},onRoughnessMapToggle:()=>{N(!A)},onEdgeHighlightToggle:()=>{O(!T)},onParticlesToggle:()=>{I(!k)}}),w&&t.jsxs("div",{className:"polling-indicator",children:[t.jsx("span",{className:"polling-spinner"}),t.jsx("span",{children:"AI generating full art... please wait"})]})]}),t.jsx("div",{className:"card-info",children:h&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card-info-header",children:[t.jsxs("div",{className:"nft-id",children:["Azuki #",n]}),h.normalImageUrl&&t.jsx("div",{className:"nft-image-container",children:t.jsx("img",{src:h.normalImageUrl,alt:`Azuki #${n}`,className:"nft-preview-image"})})]}),t.jsxs("div",{className:"card-details",children:[t.jsx("h3",{className:"details-header",children:"Traits"}),t.jsx("div",{className:"traits",children:h.traits})]}),t.jsxs("div",{className:"card-stats",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("span",{className:"stat-label",children:"Type"}),t.jsx("span",{className:"stat-value",children:h.type})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("span",{className:"stat-label",children:"HP"}),t.jsx("span",{className:"stat-value",children:h.hp})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("span",{className:"stat-label",children:"Move"}),t.jsxs("span",{className:"stat-value",children:[h.move.name," (",h.move.damage,")"]})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("span",{className:"stat-label",children:"Weakness"}),t.jsx("span",{className:"stat-value",children:h.weakness})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("span",{className:"stat-label",children:"Resistance"}),t.jsx("span",{className:"stat-value",children:h.resistance})]})]}),w&&t.jsxs("div",{className:"card-info-status",children:[t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill"})}),t.jsx("div",{className:"status-message",children:"AI is generating full art using the character description..."})]})]})})]})}),d&&t.jsx(xn,{onSelectItem:e=>{p(!1),setTimeout((()=>{j(!1),s(e),a(e),r(`/nft/${e}`,{replace:!0}),setTimeout((()=>{l(!0)}),100)}),50)},onClose:()=>{p(!1)}})]})},bn=[{id:"1834",normalUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/1834.png",fullArtUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/1834.png"},{id:"3576",normalUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/3576.png",fullArtUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/3576.png"},{id:"5991",normalUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/5991.png",fullArtUrl:"https://ipfs.io/ipfs/QmYDvPAXtiJg7s8JdRBSLWdgSphQdac8j1YuQNNxcGE1hg/5991.png"}],vn={1834:{cardName:"Azuki #1834",hp:"120",type:"🔥",move:{name:"Mystical Blade",damage:"80"},moveDescription:"Channels ancient energy into a devastating strike, cutting through defenses with spiritual precision.",weakness:"💧",resistance:"🪨",retreatCost:"⭐⭐",rarity:"⭐⭐⭐",normalImageUrl:bn[0].normalUrl,fullArtImageUrl:bn[0].fullArtUrl,cardColor:"#ff5722",traits:"Type: Human, Hair: Red, Eyes: Closed, Mouth: Grin, Clothing: Kimono, Background: Off White Red, Offhand: Dagger, Special: BEANZ, Headgear: Straw Hat, Rarity: Rare"},3576:{cardName:"Azuki #3576",hp:"90",type:"💧",move:{name:"Spirit Surge",damage:"60"},moveDescription:"Summons a wave of spiritual energy that flows like water, washing away opponents with its tranquil force.",weakness:"⚡",resistance:"🔥",retreatCost:"⭐",rarity:"⭐⭐",normalImageUrl:bn[1].normalUrl,fullArtImageUrl:bn[1].fullArtUrl,cardColor:"#2196f3",traits:"Type: Human, Hair: Blonde, Eyes: Dizzy, Mouth: Triangle, Clothing: Qipao, Background: Cool Gray, Offhand: Fan, Special: None, Headgear: Flower Pin, Rarity: Uncommon"},5991:{cardName:"Azuki #5991",hp:"150",type:"🪨",move:{name:"Mountain Slam",damage:"100"},moveDescription:"Harnesses the raw power of the earth, creating a tremor that shakes the battlefield and stuns opponents.",weakness:"🔥",resistance:"⚡",retreatCost:"⭐⭐⭐",rarity:"⭐⭐⭐⭐",normalImageUrl:bn[2].normalUrl,fullArtImageUrl:bn[2].fullArtUrl,cardColor:"#795548",traits:"Type: Human, Hair: Pink, Eyes: Suspicious, Mouth: Frown, Clothing: Jacket, Background: Off White Purple, Offhand: Katana, Special: Blue Spirit, Headgear: None, Rarity: Ultra Rare"}},jn=vn[1834],Sn=()=>{const[e,r]=f.useState(!0),[n,a]=f.useState(jn),[o,s]=f.useState(!0),[i,l]=f.useState(!0),[c,u]=f.useState(0);f.useEffect((()=>{const e=bn[c].id;r(!0);a(vn[e]);const t=setTimeout((()=>{r(!1)}),1e3);return()=>clearTimeout(t)}),[c]);return t.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#f0f0f0"},children:[t.jsx("h1",{children:"Layered 3D Card Demo"}),t.jsx("div",{style:{width:"500px",height:"700px",border:"1px solid #ccc",borderRadius:"8px",overflow:"hidden"},children:t.jsx(Ie,{cardData:n,isLoading:e,isFullArt:o,showHoloFoil:i,onImageLoadStart:()=>{},onImageLoadComplete:()=>{},onImageLoadError:e=>{}})}),t.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[t.jsxs("p",{children:["Card Type: ",n.type," | HP: ",n.hp," | Rarity: ",n.rarity]}),t.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[t.jsx("button",{onClick:()=>s(!o),style:{padding:"10px 20px",background:"#ff5722",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:o?"Show Normal Card":"Show Full Art Card"}),t.jsx("button",{onClick:()=>l(!i),style:{padding:"10px 20px",background:i?"#4caf50":"#9e9e9e",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:i?"Hide Holo Effect":"Show Holo Effect"})]}),t.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[t.jsx("button",{onClick:()=>u((e=>(e-1+bn.length)%bn.length)),style:{padding:"10px 20px",background:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Previous Card"}),t.jsx("button",{onClick:()=>u((e=>(e+1)%bn.length)),style:{padding:"10px 20px",background:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Next Card"})]}),t.jsxs("p",{style:{marginTop:"10px"},children:["Viewing Card ",c+1," of ",bn.length,": Azuki #",bn[c].id]})]})]})};function Cn(){return t.jsx(x,{children:t.jsx("div",{className:"app",children:t.jsxs(w,{children:[t.jsx(b,{path:"/",element:t.jsx(wn,{})}),t.jsx(b,{path:"/nft/:id",element:t.jsx(wn,{})}),t.jsx(b,{path:"/layered-card",element:t.jsx(Sn,{})})]})})})}p({DirectionalLight:J,PointLight:V,SpotLight:G,AmbientLight:X,Mesh:U,Group:P}),window.THREE=K,h.createRoot(document.getElementById("root")).render(t.jsx(m.StrictMode,{children:t.jsx(Cn,{})}));